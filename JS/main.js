var music_scale;
var ToneBPM = 140;
var BPNConvertMSEC = 60 / ToneBPM * 1000;
Tone.Transport.bpm.value = ToneBPM;
console.log(BPNConvertMSEC);

var count = 0;

var melody_length_ary1 = [
    0.182291666666667,0.172916666666667,0.195833333333333,0.189583333333333,0.2,0.161979166666667,0.172916666666667,0.190104166666667,0.352083333333333,0.182291666666667,0.1609375,0.208854166666667,0.31875,0.1859375,0.190104166666667,0.189583333333333,
    0.347395833333333,0.141666666666667,0.175,0.178645833333333,0.179166666666667,0.184375,0.180729166666667,0.182291666666667,0.172916666666667,0.1953125,0.344791666666667,0.1671875,0.172916666666667,0.191666666666667,0.328645833333333,0.184375,
    0.165625,0.179166666666667,0.578645833333333,0.1453125,0.178645833333333,0.188541666666667,0.168229166666667,0.197395833333333,0.178645833333333,0.169270833333333,0.1859375,0.3453125,0.190104166666667,0.160416666666667,0.1953125,0.335416666666667,
    0.178645833333333,0.202083333333333,0.189583333333333,0.335416666666667,0.138541666666667,0.172916666666667,0.178645833333333,0.175,0.2015625,0.2203125,0.183333333333333,0.161979166666667,0.202604166666667,0.3375,0.15625,0.168229166666667,
    0.184895833333333,0.321354166666667,0.190625,0.178645833333333,0.178645833333333,0.4140625,0.205729166666667,0.201041666666667,0.195833333333333,0.375,0.171875,0.199479166666667,0.188020833333333,0.352083333333333,0.172916666666667,0.207291666666667,
    0.2125,0.324479166666667,0.189583333333333,0.211979166666667,0.21875,0.36875,0.0744791666666667,0.1515625,0.279166666666667,0.100520833333333,0.1625,0.279166666666667,0.2015625,0.1609375,0.245833333333333,0.1953125,
    0.178645833333333,0.1625,0.168229166666667,0.190625,0.179166666666667,0.172916666666667,0.1859375,0.211979166666667,0.160416666666667,0.161979166666667,0.205729166666667,0.31875,0.172916666666667,0.178645833333333,0.1828125,0.341145833333333,
    0.184895833333333,0.190625,0.2015625,0.314583333333333,0.1359375,0.172916666666667,0.168229166666667,0.178645833333333,0.178645833333333,0.199479166666667,0.1828125,0.179166666666667,0.184375,0.334375,0.1953125,0.160416666666667,
    0.191666666666667,0.3390625,0.1671875,0.179166666666667,0.229166666666667,2.03802083333333,2.025
];
var melody_time_ary1 = [
    3330,3663,3996,4329,4662,4995,5328,5661,5994,6993,7326,7659,7992,8991,9324,9657,
    9990,10989,11322,11655,11988,12321,12654,12987,13320,13653,13986,14985,15318,15651,15984,16983,
    17316,17649,17982,19314,19647,19980,20313,20646,20979,21312,21645,21978,22977,23310,23643,23976,
    24975,25308,25641,25974,26973,27306,27639,27972,28305,28638,28971,29304,29637,29970,30969,31302,
    31635,31968,32967,33300,33633,33966,34965,35298,35631,35964,36963,37296,37629,37962,38961,39294,
    39627,39960,40959,41292,41625,41958,42624,42957,43290,43956,44289,44622,44955,45288,45621,45954,
    46287,46620,46953,47286,47619,47952,48285,48618,48951,49284,49617,49950,50949,51282,51615,51948,
    52947,53280,53613,53946,54945,55278,55611,55944,56277,56610,56943,57276,57609,57942,58941,59274,
    59607,59940,60939,61272,61605,61938,61938
];
var melody_data1 = [
    'E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4','A4','B4','E4','G#4','B4',
    'C5','E4','E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4','A4','B4','E4',
    'C5','B4','A4','E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4','A4','B4',
    'E4','G#4','B4','C5','E4','E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4',
    'A4','B4','E4','C5','B4','A4','B4','C5','D5','E5','G4','F5','E5','D5','F4','E5',
    'D5','C5','E4','D5','C5','B4','E4','E4','E5','E5','E5','E6','D#5','E5','D#5','E5',
    'D#5','E5','D#5','E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4','A4','B4',
    'E4','G#4','B4','C5','E4','E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4',
    'A4','B4','D4','C5','B4','A4','C4'
];
var melody_length_ary2 = [
    0.369791666666667,0.643229166666667,0.370833333333333,0.669791666666667,0.341145833333333,0.659895833333333,0.328645833333333,0.6640625,0.353125,0.667708333333333,0.656770833333333,0.385416666666667,0.659895833333333,0.375,0.671875,0.335416666666667,
    0.660416666666667,0.3359375,0.665625,0.352083333333333,0.688020833333333,0.698958333333333,0.172916666666667,0.717708333333333,0.175,0.772395833333333,0.177083333333333,0.689583333333333,1.034375,1.07291666666667,0.351041666666667,0.653125,
    0.367708333333333,0.665625,0.3296875,0.647395833333333,0.3453125,0.666145833333333,0.36875,0.408333333333333,2.03802083333333,2.025
];
var melody_time_ary2 = [
    5999,6666,7998,8665,9997,10664,13994,14661,
    15993,16660,17992,21989,22656,23988,24655,25987,
    26654,29984,30651,31983,32650,33982,36314,36647,
    38312,38645,40310,40643,41975,41975,49969,50636,
    51968,52635,53967,54634,57964,58631,59963,60630,
    61962,61962
];
var melody_data2 = [
    'A3','E3','G#3','E3','A3','E3','A3','E3','G#3','E3','A3','A3','E3','G#3','E3','A3',
    'E3','A3','E3','G#3','E3','A3','G3','C4','G3','B3','A3','C4','E3','G#3','A3','E3',
    'G#3','E3','A3','E3','A3','E3','G#3','E3','A2','E3'
];

/*
//channel:1
var melody_length_ary1 = [
    0.786979166666667,0.440104166666667,0.532291666666667,0.1734375,0.520833333333333,0.439583333333333,1.66666666666667,0.439583333333333,0.1734375,0.520833333333333,0.439583333333333,1.66614583333333,0.532291666666667,0.173958333333333,0.5203125,0.440104166666667,
    1.05260416666667,0.786979166666667,0.786979166666667,0.439583333333333,0.532291666666667,0.1734375,0.520833333333333,0.439583333333333,1.66614583333333,0.440104166666667,0.1734375,0.520833333333333,0.439583333333333,1.66614583333333,0.532291666666667,0.1734375,
    0.520833333333333,0.439583333333333,0.8796875,0.786979166666667,0.532291666666667,0.1734375,0.520833333333333,0.439583333333333,1.66614583333333,0.440104166666667,0.1734375,0.520833333333333,0.439583333333333,1.66614583333333,0.532291666666667,0.1734375,
    0.520833333333333,0.439583333333333,1.053125,0.786458333333333,0.786979166666667,0.439583333333333,0.625,0.1734375,0.520833333333333,0.439583333333333,1.66614583333333,0.439583333333333,0.173958333333333,0.5203125,0.440104166666667,1.66614583333333,
    0.532291666666667,0.1734375,0.520833333333333,0.439583333333333,1.06875,0.786979166666667
    ];
    var melody_time_ary1 = [
    0,666,1541,2563,2896,3896,4740,7940,8784,9117,10117,10961,14160,15182,15516,16515,
    17360,19048,50537,51204,52048,53070,53403,54403,55247,58446,59291,59624,60624,61468,64667,65689,
    66022,67022,67866,69555,147166,148188,148521,149521,150365,153564,154409,154742,155742,156586,159785,160807,
    161140,162140,162984,164673,192607,193274,194118,195318,195651,196651,197495,200694,201538,201872,202871,203716,
    206915,207937,208270,209270,210114,211833
    ];
    var melody_data1 = [
    'F#5','G5','A5','A5','A5','A5','A5','A5','A5','A5','A5','A5','F#5','F#5','F#5','F#5',
    'F#5','B5','F#5','G5','A5','A5','A5','A5','A5','A5','A5','A5','A5','A5','F#5','F#5',
    'F#5','F#5','F#5','B5','A5','A5','A5','A5','A5','A5','A5','A5','A5','A5','F#5','F#5',
    'F#5','F#5','F#5','B5','F#5','G5','A5','A5','A5','A5','A5','A5','A5','A5','A5','A5',
    'F#5','F#5','F#5','F#5','F#5','B5'
    ];
    //channel:2
    var melody_length_ary2 = [
    3.33229166666667,3.3265625,3.41354166666667,3.50052083333333,0.786979166666667,0.613020833333333,0.439583333333333,0.266145833333333,2.63802083333333,0.1734375,2.01354166666667,0.786979166666667,0.613020833333333,0.439583333333333,0.266145833333333,0.613541666666667,
    2.01354166666667,2.01302083333333,0.347395833333333,1.66614583333333,0.786979166666667,0.613541666666667,0.439583333333333,0.266145833333333,2.54583333333333,0.1734375,2.01354166666667,0.786458333333333,0.613020833333333,0.439583333333333,0.266145833333333,0.613541666666667,
    2.01354166666667,2.02916666666667,2.02916666666667,0.971875,0.786458333333333,0.439583333333333,0.532291666666667,0.532291666666667,0.173958333333333,0.173958333333333,0.5203125,0.5203125,0.440104166666667,0.440104166666667,0.532291666666667,1.66614583333333,
    0.694270833333333,0.694270833333333,0.439583333333333,0.266145833333333,0.439583333333333,0.439583333333333,0.1734375,0.1734375,0.520833333333333,0.520833333333333,0.439583333333333,2.10625,1.66666666666667,1.134375,0.5203125,0.440104166666667,
    0.266145833333333,0.532291666666667,0.532291666666667,0.1734375,0.1734375,0.520833333333333,0.520833333333333,2.10572916666667,1.66614583333333,1.66614583333333,0.346875,0.231770833333333,0.463020833333333,0.555208333333333,0.439583333333333,0.786979166666667,
    0.5203125,0.5203125,0.5203125,0.266145833333333,0.266145833333333,0.266145833333333,1.66666666666667,1.66666666666667,1.66666666666667,1.134375,1.66614583333333,0.346875,0.347395833333333,0.347395833333333,0.346875,0.346875,
    0.439583333333333,0.266145833333333,1.66666666666667,0.347395833333333,0.347395833333333,0.346875,0.346875,0.347395833333333,0.440104166666667,0.266145833333333,1.5734375,0.346875,0.346875,0.347395833333333,0.347395833333333,0.346875,
    0.439583333333333,0.266145833333333,1.66614583333333,0.346875,0.346875,0.347395833333333,0.347395833333333,0.346875,0.439583333333333,0.266145833333333,1.66614583333333,0.346875,0.347395833333333,0.347395833333333,0.346875,0.346875,
    0.439583333333333,0.266145833333333,1.66666666666667,0.347395833333333,0.347395833333333,0.346875,0.346875,0.347395833333333,0.440104166666667,0.266145833333333,1.5734375,0.346875,0.346875,0.347395833333333,0.347395833333333,0.346875,
    0.439583333333333,0.266145833333333,1.68229166666667,0.786979166666667,0.439583333333333,0.532291666666667,0.532291666666667,0.1734375,0.1734375,0.520833333333333,0.520833333333333,0.439583333333333,0.439583333333333,0.532291666666667,1.66614583333333,0.694270833333333,
    0.694270833333333,0.439583333333333,0.266145833333333,0.439583333333333,0.439583333333333,0.173958333333333,0.173958333333333,0.5203125,0.5203125,0.440104166666667,2.10625,1.66614583333333,1.13385416666667,0.520833333333333,0.439583333333333,0.266145833333333,
    0.532291666666667,0.532291666666667,0.1734375,0.1734375,0.520833333333333,0.520833333333333,1.66614583333333,0.439583333333333,1.66614583333333,0.23125,0.670833333333333,0.555208333333333,0.439583333333333,0.266145833333333,3.24010416666667,0.346875,
    0.8796875,1.30729166666667,0.694270833333333,0.694270833333333,0.786458333333333,0.613020833333333,0.439583333333333,0.266145833333333,1.66614583333333,0.867708333333333,0.347395833333333,0.960416666666667,0.786458333333333,0.613020833333333,0.439583333333333,0.266145833333333,
    0.786979166666667,0.868229166666667,0.867708333333333,0.960416666666667,0.786979166666667,0.613541666666667,0.439583333333333,0.266145833333333,0.705729166666667,1.30729166666667,1.13385416666667,0.1734375,0.786979166666667,0.439583333333333,0.879166666666667,1.04166666666667,
    0.694270833333333,0.346875,0.786979166666667,0.613541666666667,0.439583333333333,0.266145833333333,0.879166666666667,1.04114583333333,0.694270833333333,0.347395833333333,0.786979166666667,0.613020833333333,0.439583333333333,0.266145833333333,0.786979166666667,1.04166666666667,
    0.694270833333333,0.346875,0.786979166666667,0.613541666666667,0.440104166666667,0.266145833333333,0.705729166666667,0.520833333333333,0.5203125,0.520833333333333,0.520833333333333,0.613541666666667,0.439583333333333,0.266145833333333,0.879166666666667,1.04166666666667,
    0.694270833333333,0.346875,0.786979166666667,0.613541666666667,0.439583333333333,0.266145833333333,0.879166666666667,1.04114583333333,0.694270833333333,0.347395833333333,0.786979166666667,0.613020833333333,0.439583333333333,0.266145833333333,0.786979166666667,1.04166666666667,
    0.694270833333333,0.346875,0.786979166666667,0.613541666666667,0.440104166666667,0.266145833333333,0.879166666666667,1.04166666666667,0.694270833333333,0.346875,0.786979166666667,0.613541666666667,0.439583333333333,0.266145833333333,0.532291666666667,0.532291666666667,
    0.1734375,0.1734375,0.520833333333333,0.520833333333333,0.439583333333333,0.439583333333333,0.532291666666667,1.66614583333333,0.694270833333333,0.694270833333333,0.439583333333333,0.266145833333333,0.439583333333333,0.439583333333333,0.173958333333333,0.173958333333333,
    0.5203125,0.5203125,0.440104166666667,2.10625,1.66614583333333,1.13385416666667,0.520833333333333,0.439583333333333,0.266145833333333,0.532291666666667,0.532291666666667,0.1734375,0.1734375,0.520833333333333,0.520833333333333,2.10572916666667,
    1.66614583333333,1.66614583333333,0.347395833333333,0.23125,0.4625,0.555208333333333,0.439583333333333,0.786979166666667,0.5203125,0.5203125,0.5203125,0.266145833333333,0.266145833333333,0.266145833333333,0.879166666666667,0.879166666666667,
    0.879166666666667,0.346875,0.179166666666667,0.0864583333333333,0.0869791666666667,0.0869791666666667,0.1734375,0.0869791666666667,1.38854166666667,0.0864583333333333,0.0864583333333333,0.0869791666666667,0.0869791666666667,0.346875,0.0869791666666667,0.0869791666666667,
    0.0864583333333333,0.694270833333333,0.0864583333333333,0.0864583333333333,0.0869791666666667,0.0869791666666667,0.1734375,0.0869791666666667,1.38854166666667,0.0864583333333333,0.0864583333333333,0.0869791666666667,0.0869791666666667,0.346875,0.0869791666666667,0.0869791666666667,
    0.0864583333333333,0.786979166666667,0.786979166666667,0.440104166666667,0.624479166666667,0.624479166666667,0.173958333333333,0.173958333333333,0.5203125,0.5203125,0.440104166666667,0.440104166666667,0.532291666666667,1.66614583333333,0.694270833333333,0.694270833333333,
    0.439583333333333,0.266145833333333,0.439583333333333,0.439583333333333,0.1734375,0.1734375,0.520833333333333,0.520833333333333,0.439583333333333,2.10572916666667,1.66614583333333,1.13385416666667,0.520833333333333,0.439583333333333,0.266145833333333,0.532291666666667,
    0.532291666666667,0.173958333333333,0.173958333333333,0.5203125,0.5203125,0.440104166666667,0.440104166666667,1.68177083333333,1.2421875,0.23125,0.4625,0.555208333333333,0.439583333333333,0.266145833333333,3.24010416666667,0.786979166666667,
    0.613541666666667,0.439583333333333,0.266145833333333,1.5734375,0.1734375,1.66666666666667,0.786979166666667,0.613020833333333,0.439583333333333,0.266145833333333,1.57395833333333,0.173958333333333,1.66614583333333,0.786979166666667,0.613020833333333,0.439583333333333,
    0.266145833333333,1.57395833333333,0.173958333333333,0.694270833333333,1.66614583333333,1.66614583333333,0.960416666666667,0.960416666666667,0.439583333333333,0.439583333333333,2.77708333333333,2.77708333333333
    ];
    var melody_time_ary2 = [
    0,522,689,855,11108,11442,11775,12108,12619,13819,14152,17684,18018,18351,18684,19195,
    20039,20373,21039,21706,23905,24238,24572,24905,25416,26438,26771,30304,30637,30970,31303,31814,
    32658,32992,33658,34325,36555,37221,38065,38065,39087,39087,39421,39421,40420,40420,41265,41265,
    42287,42620,43620,43953,44464,44464,45308,45308,45641,45641,46641,46641,47485,48507,48841,49840,
    50174,50685,50685,51707,51707,52040,52040,53040,53040,53884,54906,55572,55794,56017,56239,57083,
    58594,58594,58594,59593,59593,59593,60104,60104,60104,61126,63334,64023,64356,64689,65023,65356,
    65689,66022,66533,67222,67555,67889,68222,68555,68888,69222,69733,70244,70577,70910,71243,71577,
    71910,72243,72754,73443,73776,74109,74442,74776,75109,75442,75953,76642,76975,77308,77642,77975,
    78308,78641,79152,79841,80174,80508,80841,81174,81507,81841,82352,82863,83196,83529,83862,84196,
    84529,84862,85373,87092,87759,88603,88603,89625,89625,89958,89958,90958,90958,91802,91802,92824,
    93157,94157,94490,95001,95001,95845,95845,96179,96179,97178,97178,98023,99045,99378,100378,100711,
    101222,101222,102244,102244,102577,102577,103577,103577,104421,106110,106332,106554,106776,107109,107651,145228,
    145894,146583,146916,147249,147583,147916,148249,148582,149093,149782,150115,150448,150782,151115,151448,151781,
    152292,152803,153137,153470,153803,154136,154470,154803,155314,156003,156336,156669,157002,157669,158544,159232,
    159566,159899,160232,160565,160899,161232,161743,162432,162765,163098,163431,163765,164098,164431,164942,165453,
    165786,166120,166453,166786,167119,167453,167964,168652,168986,169319,169652,169985,170319,170652,171163,171851,
    172185,172518,172851,173184,173518,173851,174362,175051,175384,175717,176050,176384,176717,177050,177561,178072,
    178405,178739,179072,179405,179738,180072,180583,181271,181605,181938,182271,182604,182938,183271,183782,183782,
    184804,184804,185137,185137,186137,186137,186981,186981,188003,188336,189336,189669,190180,190180,191024,191024,
    191358,191358,192357,192357,193202,194224,194557,195557,195890,196401,196401,197423,197423,197756,197756,198756,
    198756,199600,200622,201289,201511,201733,201955,202830,204341,204341,204341,205340,205340,205340,205882,205882,
    205882,206904,207601,208112,208445,208778,209112,209778,210111,213111,213444,213777,214110,214444,215110,215443,
    216110,216776,218443,218776,219109,219442,219776,220442,220775,223775,224108,224441,224774,225108,225774,226107,
    226774,227440,229315,229981,230826,230826,232025,232025,232359,232359,233358,233358,234203,234203,235225,235558,
    236558,236891,237402,237402,238246,238246,238579,238579,239579,239579,240423,241445,241778,242778,243111,243622,
    243622,244644,244644,244978,244978,245977,245977,246822,246822,248541,248763,248985,249207,249540,250082,261190,
    261523,261857,262190,262701,263545,263878,273809,274143,274476,274809,275320,276164,276498,286428,286762,287095,
    287428,287939,288783,289117,290961,290961,292316,292316,293316,293316,294160,294160
    ];
    var melody_data2 = [
    'A4','D5','E5','A5','A4','D5','E5','F#5','E5','D5','D5','A4','D5','E5','F#5','E5',
    'D5','E5','F#5','F#5','A4','D5','E5','F#5','E5','D5','D5','A4','D5','E5','F#5','E5',
    'D5','E5','A5','F#5','F#4','G4','A4','C#5','A4','C#5','A4','C#5','A4','C#5','D5','B4',
    'F#5','D5','F#5','G5','A4','C#5','A4','C#5','A4','C#5','A4','C#5','A4','F#5','D5','D5',
    'E5','D5','G#4','D5','G#4','G#4','D5','G#4','D5','B4','B5','E5','F#5','E5','D5','E5',
    'E5','B4','G4','E5','B4','G4','E5','B4','G4','C#5','D5','E5','F#5','E5','F#5','E5',
    'F#5','E5','D5','E5','F#5','E5','F#5','E5','F#5','E5','D5','E5','F#5','E5','F#5','E5',
    'F#5','E5','D5','E5','F#5','E5','F#5','E5','F#5','E5','D5','E5','F#5','E5','F#5','E5',
    'F#5','E5','D5','E5','F#5','E5','F#5','E5','F#5','E5','D5','E5','F#5','E5','F#5','E5',
    'F#5','E5','D5','F#4','G4','A4','C#5','A4','C#5','A4','C#5','A4','C#5','D5','B4','F#5',
    'D5','F#5','G5','A4','C#5','A4','C#5','A4','C#5','A4','C#5','A4','F#5','D5','D5','E5',
    'D5','G#4','D5','G#4','G#4','D5','D5','G#4','G4','E5','F#5','E5','D5','B4','D5','B4',
    'F#5','B4','D5','E5','F#5','A4','D5','E5','G4','B4','D5','E5','D5','C#5','B4','A4',
    'B4','F#4','G4','A4','B4','E4','F#4','G4','A4','D4','F#4','A4','A4','D5','A5','A4',
    'D5','E5','A5','E5','D5','A4','A5','A4','D5','E5','A5','E5','D5','A4','A5','A4',
    'D5','E5','A5','E5','D5','A4','A5','A4','D5','A5','A4','D5','A5','A4','A5','A4',
    'D5','E5','A5','E5','D5','A4','A5','A4','D5','E5','A5','E5','D5','A4','A5','A4',
    'D5','E5','A5','E5','D5','A4','A5','A4','D5','E5','A5','E5','D5','A4','A4','C#5',
    'A4','C#5','A4','C#5','A4','C#5','D5','B4','F#5','D5','F#5','G5','A4','C#5','A4','C#5',
    'A4','C#5','A4','C#5','A4','F#5','D5','D5','E5','D5','G#4','D5','G#4','G#4','D5','G#4',
    'D5','B4','B5','E5','F#5','E5','D5','E5','E5','B4','G4','E5','B4','G4','E5','B4',
    'G4','C#5','A4','D5','E5','F#5','E5','D5','D5','A4','D5','E5','F#5','E5','D5','E5',
    'F#5','F#5','A4','D5','E5','F#5','E5','D5','D5','A4','D5','E5','F#5','E5','D5','E5',
    'A5','F#5','F#4','G4','A4','C#5','A4','C#5','A4','C#5','A4','C#5','D5','B4','F#5','D5',
    'F#5','G5','A4','C#5','A4','C#5','A4','C#5','A4','C#5','A4','F#5','D5','D5','E5','D5',
    'G#4','D5','G#4','G#4','D5','G#4','D5','G4','D5','E5','F#5','E5','D5','B4','D5','A4',
    'D5','E5','F#5','E5','D5','D5','A4','D5','E5','F#5','E5','D5','D5','A4','D5','E5',
    'F#5','E5','D5','D5','B4','B3','A4','A3','G4','G3','F#4','F#3'
    ];
    //channel:3
    var melody_length_ary3 = [
    1.77447916666667,0.694270833333333,0.786458333333333,0.439583333333333,1.68229166666667,0.694270833333333,0.786979166666667,0.439583333333333,1.58958333333333,0.694270833333333,0.786458333333333,0.439583333333333,1.68229166666667,0.694270833333333,0.786979166666667,0.440104166666667,
    1.68229166666667,0.694270833333333,0.786979166666667,0.439583333333333,1.68229166666667,0.694270833333333,0.786979166666667,0.439583333333333,1.58958333333333,0.694270833333333,0.786979166666667,0.439583333333333,1.68229166666667,0.694270833333333,0.786979166666667,0.439583333333333,
    1.66614583333333,0.694270833333333,0.786458333333333,0.439583333333333,1.66614583333333,0.694270833333333,0.786458333333333,0.439583333333333,1.57395833333333,0.694270833333333,0.786979166666667,0.439583333333333,1.66614583333333,0.694270833333333,0.786979166666667,0.439583333333333,
    1.66614583333333,0.694270833333333,0.786458333333333,0.439583333333333,1.66666666666667,0.694270833333333,0.786979166666667,0.440104166666667,1.5734375,0.694270833333333,0.786979166666667,0.439583333333333,0.879166666666667,1.13385416666667,0.786979166666667,0.786979166666667,
    0.786979166666667,1.66614583333333,0.694270833333333,0.786458333333333,0.439583333333333,1.68229166666667,0.694270833333333,0.786979166666667,0.440104166666667,1.58958333333333,0.694270833333333,0.786458333333333,0.439583333333333,1.68229166666667,0.694270833333333,0.786979166666667,
    0.440104166666667,1.68229166666667,0.694270833333333,0.786979166666667,0.439583333333333,1.68229166666667,0.694270833333333,0.786979166666667,0.439583333333333,1.58958333333333,0.694270833333333,0.786979166666667,0.440104166666667,1.68229166666667,0.694270833333333,0.786979166666667,
    0.439583333333333,1.66614583333333,0.694270833333333,0.786979166666667,0.439583333333333,1.66614583333333,0.694270833333333,0.786458333333333,0.439583333333333,1.57395833333333,0.694270833333333,0.786979166666667,0.439583333333333,1.66614583333333,0.694270833333333,0.786979166666667,
    0.439583333333333,1.66614583333333,0.694270833333333,0.786458333333333,0.439583333333333,1.66614583333333,0.694270833333333,0.786458333333333,0.439583333333333,3.24010416666667,2.8,1.66614583333333,0.971875,1.66614583333333,1.13385416666667,0.786979166666667,
    0.786979166666667,0.786979166666667,0.439583333333333,0.439583333333333,1.66666666666667,1.134375,0.786979166666667,0.440104166666667,1.66614583333333,1.134375,0.786979166666667,0.440104166666667,1.57395833333333,1.13385416666667,0.786979166666667,0.440104166666667,
    0.705729166666667,0.705729166666667,0.520833333333333,0.520833333333333,0.439583333333333,0.439583333333333,1.66614583333333,1.13385416666667,0.786979166666667,0.439583333333333,1.66614583333333,1.13385416666667,0.786979166666667,0.439583333333333,1.5734375,1.13385416666667,
    0.786979166666667,0.439583333333333,0.705729166666667,0.705729166666667,0.520833333333333,0.520833333333333,0.439583333333333,0.439583333333333,1.66614583333333,1.66614583333333,0.786979166666667,0.786979166666667,1.66614583333333,1.66614583333333,0.786458333333333,0.786458333333333,
    1.57395833333333,1.57395833333333,0.786979166666667,0.786979166666667,1.66614583333333,1.66614583333333,0.786979166666667,0.786979166666667,1.66614583333333,1.66614583333333,0.786979166666667,0.786979166666667,1.66614583333333,1.66614583333333,0.786458333333333,0.786458333333333,
    1.5734375,1.5734375,0.347395833333333,0.786458333333333,0.786458333333333,1.66614583333333,0.346875,0.786979166666667,0.786979166666667,0.346875,0.0869791666666667,0.0864583333333333,0.0869791666666667,0.346875,0.0869791666666667,0.0864583333333333,
    0.0869791666666667,0.346875,0.0869791666666667,0.0864583333333333,0.0869791666666667,0.346875,0.0869791666666667,0.0864583333333333,0.0869791666666667,0.346875,0.0869791666666667,0.0864583333333333,0.0869791666666667,0.346875,0.0869791666666667,0.0864583333333333,
    0.0869791666666667,0.346875,0.0869791666666667,0.0864583333333333,0.0869791666666667,1.57395833333333,0.694270833333333,0.786979166666667,0.440104166666667,1.75885416666667,0.694270833333333,0.786979166666667,0.440104166666667,1.66614583333333,0.694270833333333,0.786979166666667,
    0.439583333333333,1.5734375,0.694270833333333,0.786979166666667,0.439583333333333,1.66614583333333,0.694270833333333,0.786458333333333,0.439583333333333,1.66666666666667,0.694270833333333,0.786979166666667,0.440104166666667,1.66614583333333,1.66614583333333,1.5734375,
    0.694270833333333,0.786458333333333,0.439583333333333,1.66614583333333,0.694270833333333,0.786458333333333,0.439583333333333,1.66666666666667,0.694270833333333,0.786979166666667,0.440104166666667,1.66614583333333,0.694270833333333,0.786979166666667,0.439583333333333,1.5734375,
    0.694270833333333,0.786458333333333,0.439583333333333,1.66666666666667,0.694270833333333,0.786979166666667,0.440104166666667,1.66614583333333,0.694270833333333,0.786979166666667,0.439583333333333,1.66614583333333,0.694270833333333,0.786979166666667,0.439583333333333,1.5734375,
    0.694270833333333,0.786458333333333,0.439583333333333,1.66666666666667,0.694270833333333,0.786979166666667,0.440104166666667,1.66614583333333,0.694270833333333,0.786979166666667,0.439583333333333,1.66614583333333,0.694270833333333,0.786979166666667,1.5734375,1.5734375,
    0.705729166666667,0.705729166666667,0.520833333333333,0.520833333333333,0.439583333333333,0.439583333333333,2.77708333333333,2.77708333333333
    ];
    var melody_time_ary3 = [
    0,1230,1897,2563,3438,4491,5157,5824,6698,7573,8240,8906,9781,10833,11500,12166,
    13041,14094,14760,15427,16301,17354,18020,18687,19562,20437,21103,21770,22644,23697,24363,25030,
    25874,26896,27563,28229,29073,30095,30762,31428,32272,33117,33783,34450,35294,36316,36982,37649,
    38493,39515,40182,40848,41692,42714,43381,44047,44892,45736,46402,47069,47913,48935,49601,49601,
    49601,51112,52134,52801,53467,54342,55394,56061,56727,57602,58477,59144,59810,60685,61737,62404,
    63070,63945,64998,65664,66331,67205,68258,68924,69591,70466,71340,72007,72673,73548,74601,75267,
    75934,76778,77800,78466,79133,79977,80999,81666,82332,83176,84021,84687,85354,86198,87220,87886,
    88553,89397,90419,91086,91752,92596,93618,94285,94951,95795,96640,97306,97973,98817,99839,100505,
    145147,145147,145814,145814,146688,147710,148377,149043,149888,150909,151576,152242,153117,153962,154628,155294,
    156139,156139,157524,157524,158555,158555,159430,160452,161118,161785,162629,163651,164317,164984,165859,166703,
    167369,168036,168880,168880,170266,170266,171296,171296,172171,172171,173859,173859,175370,175370,177059,177059,
    178569,178569,180080,180080,181591,181591,183279,183279,184790,184790,186478,186478,187989,187989,189678,189678,
    191219,191219,192063,192730,192730,194271,195293,195959,195959,197501,198167,198834,199500,200167,200833,201500,
    202166,202833,203499,204166,204832,205499,206165,206832,207498,208165,208831,209498,210164,210831,211497,212164,
    212830,213497,214163,214830,215496,216193,217037,217704,218370,219215,220414,221081,221747,222592,223614,224280,
    224947,225791,226635,227301,227968,228812,229834,230501,231167,232011,233033,233700,234366,235211,235211,238410,
    239254,239921,240587,241431,242453,243120,243786,244630,245652,246319,246985,247830,248852,249518,250185,251029,
    251873,252540,253206,254050,255072,255739,256405,257250,258272,258938,259605,260449,261471,262137,262804,263648,
    264492,265159,265825,266669,267691,268358,269024,269869,270891,271557,272224,273068,274090,274756,276298,276298,
    279350,279350,280705,280705,281705,281705,282549,282549
    ];
    var melody_data3 = [
    'B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D3','A3','D4','A3',
    'B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D3','A3','D4','A3',
    'A2','E3','A3','E3','G2','D3','G3','D3','F#2','C#3','A3','C#3','B2','F#3','B3','F#3',
    'E2','B2','E3','B2','G2','D3','G3','D3','A2','E3','A3','E3','A2','E3','A3','A2',
    'A1','B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D3','A3','D4',
    'A3','B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D3','A3','D4',
    'A3','A2','E3','A3','E3','G2','D3','G3','D3','F#2','C#3','A3','C#3','B2','F#3','B3',
    'F#3','E2','B2','E3','B2','A2','E3','A3','E3','D2','A2','D3','F#3','A3','F#3','D3',
    'A2','A3','D3','D4','D2','A2','D3','E3','E2','B2','E3','F#3','F#2','C#3','F#3','A3',
    'G3','G2','F#3','F#2','E3','E2','D2','A2','D3','E3','E2','B2','E3','F#3','F#2','C#3',
    'F#3','A3','G3','G2','F#2','F#3','E3','E2','A1','A2','A3','E3','G2','G1','D3','G3',
    'F#2','F#1','C#3','A3','B2','B1','F#3','B3','E1','E2','B2','E3','G1','G2','D3','G3',
    'A1','A2','E3','E3','A3','A2','E3','E3','A3','B2','F#3','B3','F#3','G2','D3','G3',
    'D3','A2','E3','A3','E3','D3','A3','D4','A3','B2','F#3','B3','F#3','G2','D3','G3',
    'D3','A2','E3','A3','E3','D3','A3','D4','A3','A2','E3','A3','E3','G2','D3','G3',
    'D3','F#2','C#3','A3','C#3','B2','F#3','B3','F#3','E2','B2','E3','B2','A2','A1','D2',
    'A2','D3','A2','B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D2',
    'A2','D3','A2','B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D2',
    'A2','D3','A2','B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','D2','D3',
    'G3','G2','F#3','F#2','E3','E2','D3','D2'
    ];
    //channel:4
    var melody_length_ary4 = [
    0.189583333333333,0.1734375,0.0864583333333333,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,
    0.173958333333333,0.805729166666667,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,0.1734375,
    0.173958333333333,0.394791666666667,0.173958333333333,0.1734375,0.173958333333333,0.1734375,0.173958333333333,0.1734375,0.173958333333333,0.1734375,0.173958333333333,0.1734375,0.173958333333333,0.1734375,0.173958333333333,0.1734375,
    0.1734375,0.1734375,0.3953125,1.61145833333333,1.62708333333333,1.5953125,1.6109375,1.61145833333333,1.61145833333333,1.5953125,1.5796875,0.394791666666667,0.173958333333333,0.1734375,0.394791666666667,0.394791666666667,
    0.1734375,0.1734375,0.394791666666667,0.3953125,0.1734375,0.1734375,0.394791666666667,0.3953125,0.1734375,0.1734375,0.394791666666667,0.394791666666667,0.1734375,0.1734375,0.394791666666667,0.394791666666667,
    0.1734375,0.173958333333333,0.394791666666667,0.394791666666667,0.1734375,0.173958333333333,0.3953125,0.805729166666667,0.115625,0.115625,0.115625,0.0864583333333333,0.0864583333333333,0.0869791666666667,0.0869791666666667,1.5796875,
    1.61145833333333,1.21614583333333,0.394791666666667,1.62760416666667,1.5796875,1.16875,0.394791666666667,1.01145833333333,0.189583333333333,0.189583333333333,0.189583333333333,1.62708333333333,0.394791666666667,0.1890625,0.189583333333333,0.189583333333333,
    0.189583333333333,0.3953125,0.189583333333333,0.1890625,0.189583333333333,0.189583333333333,0.394791666666667,0.189583333333333,0.189583333333333,0.189583333333333,0.189583333333333,0.394791666666667,0.189583333333333,0.1890625,0.189583333333333,0.1890625,
    0.394791666666667,0.189583333333333,0.189583333333333,0.1890625,0.189583333333333,0.394791666666667,0.189583333333333,0.189583333333333,0.189583333333333,0.189583333333333,0.3953125,0.189583333333333,0.189583333333333,0.189583333333333,0.189583333333333,0.394791666666667,
    0.1890625,0.189583333333333,0.189583333333333,0.189583333333333,1.62708333333333,1.62708333333333,1.62708333333333,0.6,0.6,0.394791666666667,1.62708333333333,1.62760416666667,1.62708333333333,0.6,0.6,0.394791666666667,
    0.189583333333333,0.805729166666667,0.1890625,0.805729166666667,0.189583333333333,0.805729166666667,0.1890625,0.805729166666667,0.189583333333333,0.805208333333333,0.1890625,0.805729166666667,0.189583333333333,0.805208333333333,0.173958333333333,0.1734375,
    0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,
    0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,
    0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,
    0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,1.61145833333333,1.62708333333333,
    1.5953125,1.6109375,1.61145833333333,1.62708333333333,0.805729166666667,1.184375,0.394791666666667,3.94895833333333,0.805729166666667,1.184375,0.394791666666667,3.9328125,0.805729166666667,1.20052083333333,0.394791666666667,3.12708333333333,
    0.600520833333333,0.600520833333333,0.394791666666667,3.15885416666667
    ];
    var melody_time_ary4 = [
    0,728,1061,1394,2061,2727,3394,4060,4727,5393,6060,6726,7393,8059,8726,9059,
    9786,10150,11728,12394,13061,13727,14394,15060,15727,16393,17060,17726,18393,19059,19726,20059,
    20725,21059,21847,22514,23180,23847,24513,25180,25846,26513,27179,27846,28512,29179,29845,30512,
    30845,31512,31875,32664,35788,38943,42037,45161,48285,51409,54503,57536,58324,58991,59688,60477,
    61265,61932,62629,63417,64206,64873,65570,66358,67147,67814,68511,69299,70088,70755,71452,72240,
    73029,73695,74393,75181,75970,76636,77333,78122,79700,79922,80144,80397,80594,80791,80988,81185,
    84248,87373,89739,90527,93682,96745,99020,99808,101780,102174,102569,102963,127446,128235,128629,129023,
    129751,130478,131267,131662,132056,132783,133511,134300,134694,135088,135816,136544,137332,137727,138121,138849,
    139576,140365,140759,141154,141881,142609,143397,143792,144186,144914,145641,146430,146824,147219,147946,148674,
    149463,149857,150251,150979,151707,154861,158016,161171,162354,163537,164326,167480,170635,173790,174973,176156,
    177611,178339,180583,181310,183554,184282,186526,187253,189497,190225,192469,193196,195440,196168,200380,200714,
    201047,201380,201713,202047,202380,202713,203046,203380,203713,204046,204379,204713,205046,205379,205712,206046,
    206379,206712,207045,207379,207712,208045,208378,208712,209045,209378,209711,210045,210378,210711,211044,211378,
    211711,212044,212377,212711,213044,213377,213710,214044,214377,214710,215043,215377,215710,216043,216376,216710,
    217043,217376,217709,218043,218376,218709,219042,219376,219709,220042,220375,220709,221042,221375,221739,224863,
    228018,231112,234236,237360,241878,243456,245761,246549,254161,255739,258044,258832,266414,267991,270327,271116,
    279816,280999,282182,282971
    ];
    var melody_data4 = [
    'B5','F#5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5',
    'F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5',
    'F#5','B4','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5',
    'B5','F#5','B5','A4','G4','F#4','B4','F#4','F#4','F#4','A4','B4','F#5','B5','F#5','G4',
    'D5','G5','D5','A4','E5','A5','E5','D5','A5','D6','A5','B4','F#5','B5','F#5','G4',
    'D5','G5','D5','A4','E5','A5','E5','D5','D4','F#4','A4','D5','E5','F#5','G5','A5',
    'G5','F#5','A5','B5','E5','A5','F#5','D5','A5','D6','A5','A6','B5','F#5','A5','B5',
    'F#5','B5','F#5','A5','B5','F#5','B5','F#5','A5','B5','F#5','B5','F#5','A5','B5','F#5',
    'B5','F#5','A5','B5','F#5','B5','F#5','A5','B5','F#5','B5','F#5','A5','B5','F#5','B5',
    'F#5','A5','B5','F#5','F#4','G4','A4','B4','A4','G4','F#4','G4','A4','B4','A4','G4',
    'A4','A4','G4','G4','F#4','F#4','B4','B4','B4','B4','B4','B4','A4','A4','B4','F#5',
    'B5','F#5','D6','F#5','B5','F#5','G4','D5','G5','D5','A5','D5','G5','D5','A4','E5',
    'A5','E5','B5','E5','A5','E5','D4','A4','D5','A5','G5','F#5','E5','D5','B4','F#5',
    'B5','F#5','D6','F#5','B5','F#5','G4','D5','G5','D5','A5','D5','G5','D5','A4','E5',
    'A5','E5','B5','E5','A5','E5','D4','A4','D5','A4','D5','A4','B4','G4','A4','G4',
    'F#4','B4','E4','A5','D6','C#6','A5','F#5','D6','C#6','A5','B5','D6','C#6','A5','F#5',
    'B4','A4','G4','F#4'
    ];
    //channel:5
    var melody_length_ary5 = [
    1.5953125,1.6109375,1.5953125,1.57916666666667,1.59583333333333,1.61145833333333,1.5953125,1.5953125,1.56354166666667,1.56354166666667,1.54739583333333,1.53177083333333,1.56354166666667,1.56354166666667,1.54791666666667,1.53177083333333,
    1.6109375,1.6109375,1.5953125,1.6109375,1.61145833333333,1.61145833333333,3.175,1.56354166666667,1.57916666666667,1.56354166666667,1.54739583333333,1.5796875,1.57916666666667,1.53177083333333,1.56354166666667,1.62708333333333,
    1.61145833333333,1.6109375,1.62708333333333,1.5953125,1.5953125,0.189583333333333,0.189583333333333,0.1890625,0.189583333333333,0.189583333333333,0.189583333333333,0.189583333333333,0.189583333333333,1.5953125,1.5953125,1.61145833333333,
    1.5953125,1.57916666666667,1.5953125,1.61145833333333,1.5953125,1.5796875,1.5953125,1.6109375,1.5953125,1.5953125,1.62760416666667,1.62708333333333,1.62708333333333,0.6,0.6,0.394791666666667,
    1.62760416666667,1.62708333333333,1.62708333333333,0.6,0.6,0.394791666666667,0.189583333333333,0.805208333333333,0.189583333333333,0.805729166666667,0.189583333333333,0.805208333333333,0.189583333333333,0.805729166666667,0.189583333333333,0.805729166666667,
    0.189583333333333,0.805729166666667,0.189583333333333,0.805729166666667,1.56354166666667,1.56354166666667,1.54739583333333,1.53177083333333,1.56354166666667,1.56354166666667,1.54791666666667,1.53177083333333,1.6109375,1.61145833333333,1.5953125,1.6109375,
    1.61145833333333,1.61145833333333,0.805729166666667,1.18489583333333,0.3953125,3.9484375,0.805729166666667,1.18489583333333,0.3953125,3.9328125,0.805208333333333,1.20052083333333,0.3953125,3.12708333333333,0.568229166666667,0.552604166666667,
    0.394791666666667,3.15885416666667
    ];
    var melody_time_ary5 = [
    0,3094,6218,9312,12402,15496,18620,21714,24835,27868,30901,33903,36902,39934,42967,45969,
    48941,52065,55189,58283,61407,64531,67655,73809,76842,79905,82938,85967,89031,92094,95065,98098,
    101252,104377,107501,110656,113749,116843,117237,117632,118026,118420,118815,119209,119603,119998,133783,136877,
    140001,143095,146186,149279,152404,155497,158588,161682,164806,167900,170993,174148,177303,180458,181641,182824,
    183612,186767,189922,193077,194260,195443,196898,197626,199869,200597,202841,203569,205812,206540,208784,209511,
    211755,212483,214727,215454,219726,222758,225791,228793,231792,234825,237857,240859,243831,246955,250079,253173,
    256297,259421,263909,265486,267791,268580,276192,277769,280074,280863,288445,290022,292357,293146,301847,302969,
    304060,304849
    ];
    var melody_data5 = [
    'F#4','D4','E4','A3','F#4','D4','E4','A3','F#4','D4','E4','A3','F#4','D4','E4','A3',
    'C#4','B3','A3','D4','G3','B3','C#4','F#4','D4','E4','A3','F#4','D4','E4','A3','C#4',
    'B3','A3','D4','G3','C#4','D3','A3','D4','F#4','A4','F#4','D5','A4','F#4','F#4','D4',
    'E4','A3','F#4','D4','E4','A3','F#4','D4','E4','A3','D4','E4','F#4','G4','F#4','E4',
    'D4','E4','F#4','G4','F#4','E4','E4','E4','D4','D4','C#4','C#4','F#4','F#4','F#4','F#4',
    'F#4','F#4','E4','E4','F#4','D4','E4','A3','F#4','D4','E4','A3','C#4','B3','A3','D4',
    'G3','C#4','D5','C#5','A4','F#4','D5','C#5','A4','B4','D5','C#5','A4','F#4','G4','F#4',
    'E4','D4'
    ];
    //channel:6
    var melody_length_ary6 = [
    1.5796875,1.5796875,1.56354166666667,1.57916666666667,1.5796875,1.5796875,1.56354166666667,1.57916666666667,1.57916666666667,1.5796875,1.56354166666667,1.57916666666667,1.54739583333333,1.515625,1.53125,1.56354166666667,
    1.54791666666667,1.51614583333333,1.53177083333333,1.56354166666667,1.62760416666667,1.61145833333333,1.61145833333333,1.5953125,1.61145833333333,1.61145833333333,3.14270833333333,1.56354166666667,1.54791666666667,1.5953125,1.57916666666667,1.54739583333333,
    1.54739583333333,1.56354166666667,1.59583333333333,1.61145833333333,1.5953125,1.61145833333333,1.61145833333333,1.62760416666667,1.62708333333333,3.14322916666667,1.5796875,1.5796875,1.56354166666667,1.5796875,1.5796875,1.5796875,
    1.56354166666667,1.57916666666667,1.5796875,1.5796875,1.56354166666667,1.57916666666667,1.62708333333333,1.62708333333333,1.62760416666667,0.600520833333333,0.600520833333333,0.394791666666667,1.62708333333333,1.62708333333333,1.62708333333333,0.600520833333333,
    0.600520833333333,0.3953125,0.1890625,0.805729166666667,0.189583333333333,0.805208333333333,0.1890625,0.805729166666667,0.189583333333333,0.805208333333333,0.189583333333333,0.805729166666667,0.189583333333333,0.805208333333333,0.1734375,0.805729166666667,
    1.54791666666667,1.51614583333333,1.53177083333333,1.56354166666667,1.54739583333333,1.515625,1.53177083333333,1.56354166666667,1.62708333333333,1.6109375,1.61145833333333,1.5953125,1.61145833333333,1.62708333333333,0.805729166666667,1.21666666666667,
    0.394791666666667,3.96458333333333,0.805208333333333,1.21614583333333,0.394791666666667,3.96458333333333,0.805729166666667,1.21614583333333,0.394791666666667,3.175,0.584375,0.568229166666667,0.394791666666667,3.15885416666667
    ];
    var melody_time_ary6 = [
    0,3063,6126,9159,12222,15285,18348,21381,24444,27507,30570,33603,36694,39696,42637,45608,
    48668,51670,54611,57583,60615,63770,66894,70019,73112,76236,79361,85454,88486,91488,94582,97673,
    100675,103677,106709,109803,112927,116021,119145,122269,125424,128579,145308,148371,151434,154467,157530,160593,
    163656,166689,169752,172815,175878,178911,181974,185129,188283,191438,192621,193804,194593,197748,200903,204057,
    205240,206423,207879,208606,210850,211578,213822,214549,216793,217521,219764,220492,222736,223464,225738,226435,
    230706,233708,236649,239621,242681,245683,248624,251595,254628,257783,260907,264031,267125,270249,274737,276314,
    278680,279469,287112,288689,291055,291844,299486,301064,303430,304218,313011,314163,315285,316074
    ];
    var melody_data6 = [
    'D4','B3','C#4','F#3','D4','B3','C#4','F#3','D4','B3','C#4','F#3','D4','B3','C#4','F#3',
    'D4','B3','C#4','F#3','E4','D4','C#4','F#4','B3','D4','E4','D4','B3','C#4','F#3','D4',
    'B3','C#4','F#3','E4','D4','C#4','F#4','B3','E4','A4','D4','B3','C#4','F#3','D4','B3',
    'C#4','F#3','D4','B3','C#4','F#3','A3','B3','C#4','D4','C#4','B3','A3','B3','C#4','D4',
    'C#4','B3','C#4','C#4','B3','B3','A3','A3','D4','D4','D4','D4','D4','D4','C#4','C#4',
    'D4','B3','C#4','F#3','D4','B3','C#4','F#3','E4','D4','C#4','F#4','B3','E4','B4','A4',
    'F#4','D4','B4','A4','F#4','G4','B4','A4','F#4','D4','D4','C#4','B3','A3'
    ];
    //channel:7
    var melody_length_ary7 = [
    1.5953125,1.54739583333333,1.53177083333333,1.53177083333333,1.59583333333333,1.54791666666667,1.53177083333333,1.53177083333333,1.5953125,1.54739583333333,1.53125,1.53177083333333,1.5953125,1.54739583333333,1.53177083333333,1.53177083333333,
    1.54739583333333,1.54739583333333,1.54739583333333,1.53177083333333,1.54791666666667,1.54791666666667,1.54791666666667,1.53177083333333,1.56354166666667,1.5796875,1.5796875,1.54791666666667,1.59583333333333,1.5953125,3.12708333333333,1.54791666666667,
    1.54791666666667,1.54791666666667,1.53177083333333,1.54791666666667,1.54739583333333,1.54739583333333,1.53177083333333,1.56354166666667,1.56354166666667,1.56354166666667,1.54739583333333,1.56354166666667,1.5796875,3.14270833333333,1.59583333333333,1.54791666666667,
    1.53177083333333,1.53177083333333,1.5953125,1.54739583333333,1.53125,1.53177083333333,1.5953125,1.54739583333333,1.53177083333333,1.53177083333333,1.5953125,1.54791666666667,1.53177083333333,1.53177083333333,1.54791666666667,1.54791666666667,
    1.54791666666667,0.56875,0.56875,0.394791666666667,1.54739583333333,1.54791666666667,1.54791666666667,0.568229166666667,0.568229166666667,0.394791666666667,0.789583333333333,0.789583333333333,0.790104166666667,0.789583333333333,0.789583333333333,0.789583333333333,
    0.789583333333333,1.54791666666667,1.54791666666667,1.54791666666667,1.53177083333333,1.54739583333333,1.54739583333333,1.54739583333333,1.53177083333333,1.56354166666667,1.57916666666667,1.57916666666667,1.54739583333333,1.5953125,1.6109375,1.5953125,
    1.54791666666667,1.53177083333333,1.53177083333333,1.5953125,1.54739583333333,1.53177083333333,1.53177083333333,1.5953125,1.54791666666667,1.53177083333333,1.53177083333333,0.584375,0.568229166666667,0.378645833333333,3.17447916666667
    ];
    var melody_time_ary7 = [
    0,3094,6096,9067,12066,15160,18162,21134,24133,27227,30229,33200,36199,39293,42295,45266,
    48266,51268,54270,57272,60271,63273,66275,69277,72249,75281,78344,81407,84409,87503,90597,96659,
    99661,102663,105665,108664,111667,114669,117671,120642,123675,126707,129740,132742,135774,138838,144930,148024,
    151026,153998,156997,160091,163093,166064,169063,172157,175159,178130,181130,184223,187225,190197,193168,196170,
    199172,202174,203296,204418,205207,208209,211211,214213,215335,216457,218579,221459,224338,227218,230098,232978,
    235858,240098,243100,246102,249104,252104,255106,258108,261110,264081,267114,270177,273240,276242,279336,282488,
    285581,288583,291555,294554,297648,300650,303621,306621,309714,312716,315688,321325,322478,323600,324358
    ];
    var melody_data7 = [
    'B2','G2','A2','D2','B2','G2','A2','D2','B2','G2','A2','D2','B2','G2','A2','D2',
    'B2','G2','A2','D2','B2','G2','A2','D2','A2','G2','F#2','B2','E2','G2','A2','B2',
    'G2','A2','D2','B2','G2','A2','D2','A2','G2','F#2','B2','E2','A2','D2','B2','G2',
    'A2','D2','B2','G2','A2','D2','B2','G2','A2','D2','B2','G2','A2','D2','D2','E2',
    'F#2','G2','F#2','E2','D2','E2','F#2','G2','F#2','E2','A2','G2','F#2','B2','E2','G2',
    'A2','B2','G2','A2','D2','B2','G2','A2','D2','A2','G2','F#2','B2','E2','A2','D3',
    'B2','G2','A2','D3','B2','G2','A2','D3','B2','G2','A2','G2','F#2','E2','D2'
    ];
*/

var melody_length_ary = melody_length_ary1;
var melody_time_ary = melody_time_ary1;
var melody_data = melody_data1;
var melodyFlagAry = createBrankAry(melody_time_ary);

var countUp = 0;
var atCount = 0;
var startTime = new Date(), atTime = new Date(), diffTime = new Date();

var beforeX = 0, beforeY = 0;
var norm_threshold = 100;

document.addEventListener("DOMContentLoaded", function(){
    var ripple_wood = document.getElementById("ripple_div");
    
    ripple_wood.addEventListener("click", function (event) { 

        var norm = Math.sqrt( Math.pow(event.pageX - beforeX,2) + Math.pow(event.pageY - beforeY, 2));
        console.log(norm);
        beforeX = event.pageX;
        beforeY = event.pageY;

        var synth = new Tone.Synth().toMaster();
        //synth.volume.value = 1;
        if(count == 0){
            //startAccompaniment(accompaniment_time_ary, accompaniment_data);
            startAccompaniment(melody_time_ary1, melody_data1, melody_length_ary1, melodyFlagAry, true);
            startAccompaniment(melody_time_ary2, melody_data2, melody_length_ary2, melodyFlagAry, false);

//            startAccompaniment(melody_time_ary3, melody_data3, melody_length_ary3, melodyFlagAry, false);
/*            startAccompaniment(melody_time_ary4, melody_data4, melody_length_ary4, melodyFlagAry, false);
            startAccompaniment(melody_time_ary5, melody_data5, melody_length_ary5, melodyFlagAry, false);
            startAccompaniment(melody_time_ary6, melody_data6, melody_length_ary6, melodyFlagAry, false);
            startAccompaniment(melody_time_ary7, melody_data7, melody_length_ary7, melodyFlagAry, false);
*/

            Tone.Transport.start();
            startTime = new Date();
            atTime = new Date();
        }
        else{
            atTime = new Date();
        }
        diffTime = atTime.getTime() - startTime.getTime();
        //console.log(diffTime);
        
        for(var i=atCount+1; i<melody_time_ary.length; i++){
           // music_scale = melody_data[countUp];
           // console.log(melody_time_ary[i] * BPNConvertMSEC);
            if((melody_time_ary[i]-100) <= diffTime + melody_time_ary[0]){
                atCount = i;
            }
        }

        var rand = Math.random() * (melody_data - 1);

        for(var i=atCount; i<atCount+10; i++){
            if(melody_time_ary[atCount] == melody_time_ary[i]){
                if(melodyFlagAry[i] == 0){
                    if(norm > norm_threshold){
                        console.log(norm);
                        music_scale = melody_data[i];
                    }
                    melodyFlagAry[i] = 1;
                    ++melodyFlagAry[i];
                }else{
                    if(norm > norm_threshold){
                        console.log(norm);
                        music_scale = melody_data[rand];
                    }
                    //music_scale = 0;
                }
                synth.triggerAttackRelease(music_scale, melody_length_ary[i]);
            }
        }
 
        //music_scale = melody_data[countUp];
        countUp++;

        if((melody_time_ary[melody_time_ary.length]) < diffTime){
            Tone.Transport.stop();
            count = 0;
        }
        else{
            count++;
        }
    }, false);

}, false);

function waitNote(msec, count, mainFlag, flagAry){
    var objDef = new $.Deferred;
    setTimeout(function(){
        objDef.resolve(count, mainFlag, flagAry);
    }, msec);
    return objDef.promise(count, mainFlag, flagAry);
}

function startAccompaniment(timeAry, dataAry, lengthAry, flagAry, mainFlag){
    var synth = new Tone.Synth().toMaster();
    for(var i=0; i<timeAry.length; i++){
        var nextTime = timeAry[i] - melody_time_ary[0];

        waitNote(nextTime, i, mainFlag, flagAry).done(function(count, mainFlag){
            if(mainFlag){
                if(flagAry[count] == 0){
                    synth.volume.value = -20;
                    var scale = dataAry[count];
                    synth.triggerAttackRelease(scale, lengthAry[count]);
                }
            }
            else{
                var scale = dataAry[count];
                synth.triggerAttackRelease(scale, lengthAry[count]); 
            }
        });
    }
}

function createBrankAry(ary){
    var tempAry = {};
    for(var i=0; i<ary.length; i++){
        tempAry[i] = 0;
    }
    return tempAry;
}
