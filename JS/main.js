var music_scale;
var ToneBPM = 200;
var BPNConvertMSEC = 60 / ToneBPM * 1000;
Tone.Transport.bpm.value = ToneBPM;
console.log(BPNConvertMSEC);

var count = 0;
/*
var melody_length_ary1 = [
    0.182291666666667,0.172916666666667,0.195833333333333,0.189583333333333,0.2,0.161979166666667,0.172916666666667,0.190104166666667,0.352083333333333,0.182291666666667,0.1609375,0.208854166666667,0.31875,0.1859375,0.190104166666667,0.189583333333333,
    0.347395833333333,0.141666666666667,0.175,0.178645833333333,0.179166666666667,0.184375,0.180729166666667,0.182291666666667,0.172916666666667,0.1953125,0.344791666666667,0.1671875,0.172916666666667,0.191666666666667,0.328645833333333,0.184375,
    0.165625,0.179166666666667,0.578645833333333,0.1453125,0.178645833333333,0.188541666666667,0.168229166666667,0.197395833333333,0.178645833333333,0.169270833333333,0.1859375,0.3453125,0.190104166666667,0.160416666666667,0.1953125,0.335416666666667,
    0.178645833333333,0.202083333333333,0.189583333333333,0.335416666666667,0.138541666666667,0.172916666666667,0.178645833333333,0.175,0.2015625,0.2203125,0.183333333333333,0.161979166666667,0.202604166666667,0.3375,0.15625,0.168229166666667,
    0.184895833333333,0.321354166666667,0.190625,0.178645833333333,0.178645833333333,0.4140625,0.205729166666667,0.201041666666667,0.195833333333333,0.375,0.171875,0.199479166666667,0.188020833333333,0.352083333333333,0.172916666666667,0.207291666666667,
    0.2125,0.324479166666667,0.189583333333333,0.211979166666667,0.21875,0.36875,0.0744791666666667,0.1515625,0.279166666666667,0.100520833333333,0.1625,0.279166666666667,0.2015625,0.1609375,0.245833333333333,0.1953125,
    0.178645833333333,0.1625,0.168229166666667,0.190625,0.179166666666667,0.172916666666667,0.1859375,0.211979166666667,0.160416666666667,0.161979166666667,0.205729166666667,0.31875,0.172916666666667,0.178645833333333,0.1828125,0.341145833333333,
    0.184895833333333,0.190625,0.2015625,0.314583333333333,0.1359375,0.172916666666667,0.168229166666667,0.178645833333333,0.178645833333333,0.199479166666667,0.1828125,0.179166666666667,0.184375,0.334375,0.1953125,0.160416666666667,
    0.191666666666667,0.3390625,0.1671875,0.179166666666667,0.229166666666667,2.03802083333333,2.025
];
var melody_time_ary1 = [
    3330,3663,3996,4329,4662,4995,5328,5661,5994,6993,7326,7659,7992,8991,9324,9657,
    9990,10989,11322,11655,11988,12321,12654,12987,13320,13653,13986,14985,15318,15651,15984,16983,
    17316,17649,17982,19314,19647,19980,20313,20646,20979,21312,21645,21978,22977,23310,23643,23976,
    24975,25308,25641,25974,26973,27306,27639,27972,28305,28638,28971,29304,29637,29970,30969,31302,
    31635,31968,32967,33300,33633,33966,34965,35298,35631,35964,36963,37296,37629,37962,38961,39294,
    39627,39960,40959,41292,41625,41958,42624,42957,43290,43956,44289,44622,44955,45288,45621,45954,
    46287,46620,46953,47286,47619,47952,48285,48618,48951,49284,49617,49950,50949,51282,51615,51948,
    52947,53280,53613,53946,54945,55278,55611,55944,56277,56610,56943,57276,57609,57942,58941,59274,
    59607,59940,60939,61272,61605,61938,61938
];
var melody_data1 = [
    'E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4','A4','B4','E4','G#4','B4',
    'C5','E4','E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4','A4','B4','E4',
    'C5','B4','A4','E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4','A4','B4',
    'E4','G#4','B4','C5','E4','E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4',
    'A4','B4','E4','C5','B4','A4','B4','C5','D5','E5','G4','F5','E5','D5','F4','E5',
    'D5','C5','E4','D5','C5','B4','E4','E4','E5','E5','E5','E6','D#5','E5','D#5','E5',
    'D#5','E5','D#5','E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4','A4','B4',
    'E4','G#4','B4','C5','E4','E5','D#5','E5','D#5','E5','B4','D5','C5','A4','C4','E4',
    'A4','B4','D4','C5','B4','A4','C4'
];
var melody_length_ary2 = [
    0.369791666666667,0.643229166666667,0.370833333333333,0.669791666666667,0.341145833333333,0.659895833333333,0.328645833333333,0.6640625,0.353125,0.667708333333333,0.656770833333333,0.385416666666667,0.659895833333333,0.375,0.671875,0.335416666666667,
    0.660416666666667,0.3359375,0.665625,0.352083333333333,0.688020833333333,0.698958333333333,0.172916666666667,0.717708333333333,0.175,0.772395833333333,0.177083333333333,0.689583333333333,1.034375,1.07291666666667,0.351041666666667,0.653125,
    0.367708333333333,0.665625,0.3296875,0.647395833333333,0.3453125,0.666145833333333,0.36875,0.408333333333333,2.03802083333333,2.025
];
var melody_time_ary2 = [
    5999,6666,7998,8665,9997,10664,13994,14661,
    15993,16660,17992,21989,22656,23988,24655,25987,
    26654,29984,30651,31983,32650,33982,36314,36647,
    38312,38645,40310,40643,41975,41975,49969,50636,
    51968,52635,53967,54634,57964,58631,59963,60630,
    61962,61962
];
var melody_data2 = [
    'A3','E3','G#3','E3','A3','E3','A3','E3','G#3','E3','A3','A3','E3','G#3','E3','A3',
    'E3','A3','E3','G#3','E3','A3','G3','C4','G3','B3','A3','C4','E3','G#3','A3','E3',
    'G#3','E3','A3','E3','A3','E3','G#3','E3','A2','E3'
];
*/

//channel:1
//inst:1
var melody_length_ary1 = [
    0.694270833333333,0.347395833333333,0.347395833333333,0.1734375,0.5203125,0.347395833333333,1.38854166666667,0.347395833333333,0.1734375,0.5203125,0.347395833333333,1.38854166666667,0.347395833333333,0.1734375,0.5203125,0.347395833333333,
    0.867708333333333,0.694270833333333,0.694270833333333,0.347395833333333,0.347395833333333,0.1734375,0.5203125,0.347395833333333,1.38854166666667,0.347395833333333,0.1734375,0.5203125,0.347395833333333,1.38854166666667,0.347395833333333,0.1734375,
    0.5203125,0.347395833333333,0.694270833333333,0.694270833333333,0.347395833333333,0.1734375,0.5203125,0.347395833333333,1.38854166666667,0.347395833333333,0.1734375,0.5203125,0.347395833333333,1.38854166666667,0.347395833333333,0.1734375,
    0.5203125,0.347395833333333,0.867708333333333,0.694270833333333,0.694270833333333,0.347395833333333,0.347395833333333,0.1734375,0.5203125,0.347395833333333,1.38854166666667,0.347395833333333,0.1734375,0.5203125,0.347395833333333,1.38854166666667,
    0.347395833333333,0.1734375,0.5203125,0.347395833333333,0.867708333333333,0.694270833333333
    ];
    var melody_time_ary1 = [
    31992,32325,32658,32992,33158,33658,33991,35324,35658,35824,36324,36657,37990,38324,38490,38990,
    39323,39990,53320,53653,53986,54320,54486,54986,55319,56652,56986,57152,57652,57985,59318,59652,
    59818,60318,60651,61318,96642,96976,97142,97642,97975,99308,99642,99808,100308,100641,101974,102308,
    102474,102974,103307,103974,117304,117637,117970,118304,118470,118970,119303,120636,120970,121136,121636,121969,
    123302,123636,123802,124302,124635,125302
    ];
    var melody_data1 = [
    'F#5','G5','A5','A5','A5','A5','A5','A5','A5','A5','A5','A5','F#5','F#5','F#5','F#5',
    'F#5','B5','F#5','G5','A5','A5','A5','A5','A5','A5','A5','A5','A5','A5','F#5','F#5',
    'F#5','F#5','F#5','B5','A5','A5','A5','A5','A5','A5','A5','A5','A5','A5','F#5','F#5',
    'F#5','F#5','F#5','B5','F#5','G5','A5','A5','A5','A5','A5','A5','A5','A5','A5','A5',
    'F#5','F#5','F#5','F#5','F#5','B5'
    ];
    var melody_volume_ary1 = [
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127
    ];
    //channel:2
    //inst:1
    var melody_length_ary2 = [
    2.77708333333333,2.86354166666667,2.95104166666667,3.0375,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,2.0828125,0.1734375,1.73541666666667,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,0.520833333333333,
    1.73541666666667,1.73541666666667,0.347395833333333,1.38854166666667,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,2.0828125,0.1734375,1.73541666666667,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,0.520833333333333,
    1.73541666666667,1.73541666666667,1.7359375,0.694270833333333,0.694270833333333,0.347395833333333,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.5203125,0.5203125,0.347395833333333,0.347395833333333,0.347395833333333,1.38854166666667,
    0.69375,0.694270833333333,0.347395833333333,0.1734375,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.5203125,0.5203125,0.347395833333333,1.7359375,1.38854166666667,1.04114583333333,0.5203125,0.347395833333333,
    0.1734375,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.5203125,0.5203125,1.7359375,1.38854166666667,1.38854166666667,0.346875,0.23125,0.463020833333333,0.463020833333333,0.347395833333333,0.694270833333333,
    0.520833333333333,0.520833333333333,0.520833333333333,0.1734375,0.1734375,0.1734375,1.38854166666667,1.38854166666667,1.38854166666667,1.04114583333333,1.38854166666667,0.347395833333333,0.346875,0.346875,0.346875,0.347395833333333,
    0.347395833333333,0.1734375,1.38854166666667,0.347395833333333,0.346875,0.346875,0.346875,0.347395833333333,0.347395833333333,0.1734375,1.38854166666667,0.347395833333333,0.346875,0.346875,0.346875,0.347395833333333,
    0.347395833333333,0.1734375,1.38854166666667,0.347395833333333,0.346875,0.346875,0.346875,0.347395833333333,0.347395833333333,0.1734375,1.38854166666667,0.347395833333333,0.346875,0.346875,0.346875,0.347395833333333,
    0.347395833333333,0.1734375,1.38854166666667,0.347395833333333,0.346875,0.346875,0.346875,0.347395833333333,0.347395833333333,0.1734375,1.38854166666667,0.347395833333333,0.346875,0.346875,0.346875,0.347395833333333,
    0.347395833333333,0.1734375,1.38854166666667,0.694270833333333,0.347395833333333,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.5203125,0.5203125,0.347395833333333,0.347395833333333,0.347395833333333,1.38854166666667,0.69375,
    0.694270833333333,0.347395833333333,0.1734375,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.5203125,0.5203125,0.347395833333333,1.7359375,1.38854166666667,1.04114583333333,0.5203125,0.347395833333333,0.1734375,
    0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.5203125,0.5203125,1.38854166666667,0.347395833333333,1.38854166666667,0.23125,0.578645833333333,0.463020833333333,0.347395833333333,0.1734375,2.77708333333333,0.347395833333333,
    0.694270833333333,1.21510416666667,0.69375,0.694270833333333,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,1.38854166666667,0.867708333333333,0.346875,0.867708333333333,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,
    0.694270833333333,0.867708333333333,0.867708333333333,0.867708333333333,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,0.520833333333333,1.21510416666667,1.04114583333333,0.1734375,0.694270833333333,0.347395833333333,0.694270833333333,1.04166666666667,
    0.69375,0.346875,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,0.694270833333333,1.04166666666667,0.69375,0.346875,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,0.694270833333333,1.04166666666667,
    0.69375,0.346875,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,0.520833333333333,0.520833333333333,0.5203125,0.5203125,0.520833333333333,0.520833333333333,0.347395833333333,0.1734375,0.694270833333333,1.04166666666667,
    0.69375,0.346875,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,0.694270833333333,1.04166666666667,0.69375,0.346875,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,0.694270833333333,1.04166666666667,
    0.69375,0.346875,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,0.694270833333333,1.04166666666667,0.69375,0.346875,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,0.347395833333333,0.347395833333333,
    0.1734375,0.1734375,0.5203125,0.5203125,0.347395833333333,0.347395833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,0.1734375,0.347395833333333,0.347395833333333,0.1734375,0.1734375,
    0.5203125,0.5203125,0.347395833333333,1.7359375,1.38854166666667,1.04114583333333,0.5203125,0.347395833333333,0.1734375,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.5203125,0.5203125,1.7359375,
    1.38854166666667,1.38854166666667,0.346875,0.23125,0.463020833333333,0.463020833333333,0.347395833333333,0.694270833333333,0.520833333333333,0.520833333333333,0.520833333333333,0.1734375,0.1734375,0.1734375,0.694270833333333,0.694270833333333,
    0.694270833333333,0.346875,0.0869791666666667,0.0869791666666667,0.0869791666666667,0.0864583333333333,0.1734375,0.0864583333333333,1.38854166666667,0.0869791666666667,0.0869791666666667,0.0869791666666667,0.0864583333333333,0.347395833333333,0.0864583333333333,0.0864583333333333,
    0.0869791666666667,0.694270833333333,0.0869791666666667,0.0869791666666667,0.0869791666666667,0.0864583333333333,0.1734375,0.0864583333333333,1.38854166666667,0.0869791666666667,0.0869791666666667,0.0869791666666667,0.0864583333333333,0.347395833333333,0.0864583333333333,0.0864583333333333,
    0.0869791666666667,0.694270833333333,0.694270833333333,0.347395833333333,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.5203125,0.5203125,0.347395833333333,0.347395833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,
    0.347395833333333,0.1734375,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.5203125,0.5203125,0.347395833333333,1.7359375,1.38854166666667,1.04114583333333,0.5203125,0.347395833333333,0.1734375,0.347395833333333,
    0.347395833333333,0.1734375,0.1734375,0.5203125,0.5203125,0.347395833333333,0.347395833333333,1.38854166666667,1.04114583333333,0.23125,0.463020833333333,0.463020833333333,0.347395833333333,0.1734375,2.77708333333333,0.694270833333333,
    0.520833333333333,0.347395833333333,0.1734375,1.38854166666667,0.1734375,1.38854166666667,0.694270833333333,0.520833333333333,0.347395833333333,0.1734375,1.38854166666667,0.1734375,1.38854166666667,0.694270833333333,0.520833333333333,0.347395833333333,
    0.1734375,1.38854166666667,0.1734375,0.694270833333333,1.38854166666667,1.38854166666667,0.867708333333333,0.867708333333333,0.347395833333333,0.347395833333333,2.77708333333333,2.77708333333333
    ];
    var melody_time_ary2 = [
    16662,16746,16829,16912,21328,21494,21661,21828,21994,22328,22494,23994,24160,24327,24494,24660,
    24994,25160,25493,25827,26660,26826,26993,27160,27326,27660,27826,29326,29492,29659,29826,29992,
    30326,30492,30825,31159,31992,32325,32658,32658,32992,32992,33158,33158,33658,33658,33991,33991,
    34325,34491,34991,35158,35324,35324,35658,35658,35824,35824,36324,36324,36657,36991,37157,37657,
    37824,37990,37990,38324,38324,38490,38490,38990,38990,39323,39657,39990,40101,40212,40323,40656,
    41323,41323,41323,41823,41823,41823,41989,41989,41989,42323,43322,43489,43656,43822,43989,44155,
    44322,44489,44655,44822,44989,45155,45322,45488,45655,45822,45988,46155,46322,46488,46655,46821,
    46988,47155,47321,47488,47655,47821,47988,48154,48321,48488,48654,48821,48988,49154,49321,49487,
    49654,49821,49987,50154,50321,50487,50654,50820,50987,51154,51320,51487,51654,51820,51987,52153,
    52320,52487,52653,53320,53653,53986,53986,54320,54320,54486,54486,54986,54986,55319,55319,55653,
    55819,56319,56486,56652,56652,56986,56986,57152,57152,57652,57652,57985,58319,58485,58985,59152,
    59318,59318,59652,59652,59818,59818,60318,60318,60651,61318,61429,61540,61651,61818,61984,80313,
    80646,80813,80980,81146,81313,81479,81646,81813,81979,82146,82313,82479,82646,82812,82979,83146,
    83312,83479,83646,83812,83979,84145,84312,84479,84645,84812,84979,85145,85312,85645,85978,86145,
    86312,86478,86645,86811,86978,87145,87311,87478,87645,87811,87978,88144,88311,88478,88644,88811,
    88978,89144,89311,89477,89644,89811,89977,90144,90311,90477,90644,90810,90977,91144,91310,91477,
    91644,91810,91977,92143,92310,92477,92643,92810,92977,93143,93310,93476,93643,93810,93976,94143,
    94310,94476,94643,94809,94976,95143,95309,95476,95643,95809,95976,96142,96309,96476,96642,96642,
    96976,96976,97142,97142,97642,97642,97975,97975,98309,98475,98975,99142,99308,99308,99642,99642,
    99808,99808,100308,100308,100641,100975,101141,101641,101808,101974,101974,102308,102308,102474,102474,102974,
    102974,103307,103641,103974,104085,104196,104307,104640,105307,105307,105307,105807,105807,105807,105973,105973,
    105973,106307,106640,106806,106973,107140,107306,107640,107806,109306,109472,109639,109806,109972,110306,110472,
    110805,111139,111972,112138,112305,112472,112638,112972,113138,114638,114804,114971,115138,115304,115638,115804,
    116137,116471,117304,117637,117970,117970,118304,118304,118470,118470,118970,118970,119303,119303,119637,119803,
    120303,120470,120636,120636,120970,120970,121136,121136,121636,121636,121969,122303,122469,122969,123136,123302,
    123302,123636,123636,123802,123802,124302,124302,124635,124635,125302,125413,125524,125635,125802,125968,130634,
    130800,130967,131134,131300,131634,131800,135966,136132,136299,136466,136632,136966,137132,141298,141464,141631,
    141798,141964,142298,142464,143297,143297,143797,143797,144297,144297,144630,144630
    ];
    var melody_data2 = [
    'A4','D5','E5','A5','A4','D5','E5','F#5','E5','D5','D5','A4','D5','E5','F#5','E5',
    'D5','E5','F#5','F#5','A4','D5','E5','F#5','E5','D5','D5','A4','D5','E5','F#5','E5',
    'D5','E5','A5','F#5','F#4','G4','A4','C#5','A4','C#5','A4','C#5','A4','C#5','D5','B4',
    'F#5','D5','F#5','G5','A4','C#5','A4','C#5','A4','C#5','A4','C#5','A4','F#5','D5','D5',
    'E5','D5','G#4','D5','G#4','G#4','D5','G#4','D5','B4','B5','E5','F#5','E5','D5','E5',
    'E5','B4','G4','E5','B4','G4','E5','B4','G4','C#5','D5','E5','F#5','E5','F#5','E5',
    'F#5','E5','D5','E5','F#5','E5','F#5','E5','F#5','E5','D5','E5','F#5','E5','F#5','E5',
    'F#5','E5','D5','E5','F#5','E5','F#5','E5','F#5','E5','D5','E5','F#5','E5','F#5','E5',
    'F#5','E5','D5','E5','F#5','E5','F#5','E5','F#5','E5','D5','E5','F#5','E5','F#5','E5',
    'F#5','E5','D5','F#4','G4','A4','C#5','A4','C#5','A4','C#5','A4','C#5','D5','B4','F#5',
    'D5','F#5','G5','A4','C#5','A4','C#5','A4','C#5','A4','C#5','A4','F#5','D5','D5','E5',
    'D5','G#4','D5','G#4','G#4','D5','D5','G#4','G4','E5','F#5','E5','D5','B4','D5','B4',
    'F#5','B4','D5','E5','F#5','A4','D5','E5','G4','B4','D5','E5','D5','C#5','B4','A4',
    'B4','F#4','G4','A4','B4','E4','F#4','G4','A4','D4','F#4','A4','A4','D5','A5','A4',
    'D5','E5','A5','E5','D5','A4','A5','A4','D5','E5','A5','E5','D5','A4','A5','A4',
    'D5','E5','A5','E5','D5','A4','A5','A4','D5','A5','A4','D5','A5','A4','A5','A4',
    'D5','E5','A5','E5','D5','A4','A5','A4','D5','E5','A5','E5','D5','A4','A5','A4',
    'D5','E5','A5','E5','D5','A4','A5','A4','D5','E5','A5','E5','D5','A4','A4','C#5',
    'A4','C#5','A4','C#5','A4','C#5','D5','B4','F#5','D5','F#5','G5','A4','C#5','A4','C#5',
    'A4','C#5','A4','C#5','A4','F#5','D5','D5','E5','D5','G#4','D5','G#4','G#4','D5','G#4',
    'D5','B4','B5','E5','F#5','E5','D5','E5','E5','B4','G4','E5','B4','G4','E5','B4',
    'G4','C#5','A4','D5','E5','F#5','E5','D5','D5','A4','D5','E5','F#5','E5','D5','E5',
    'F#5','F#5','A4','D5','E5','F#5','E5','D5','D5','A4','D5','E5','F#5','E5','D5','E5',
    'A5','F#5','F#4','G4','A4','C#5','A4','C#5','A4','C#5','A4','C#5','D5','B4','F#5','D5',
    'F#5','G5','A4','C#5','A4','C#5','A4','C#5','A4','C#5','A4','F#5','D5','D5','E5','D5',
    'G#4','D5','G#4','G#4','D5','G#4','D5','G4','D5','E5','F#5','E5','D5','B4','D5','A4',
    'D5','E5','F#5','E5','D5','D5','A4','D5','E5','F#5','E5','D5','D5','A4','D5','E5',
    'F#5','E5','D5','D5','B4','B3','A4','A3','G4','G3','F#4','F#3'
    ];
    var melody_volume_ary2 = [
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127
    ];
    //channel:3
    //inst:1
    var melody_length_ary3 = [
    1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,
    1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,
    1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,
    1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,0.694270833333333,1.04114583333333,0.694270833333333,0.694270833333333,
    0.694270833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,
    0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,
    0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,
    0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,2.77708333333333,2.4296875,1.38854166666667,0.694791666666667,1.38854166666667,1.04114583333333,0.694270833333333,
    0.694270833333333,0.694270833333333,0.347395833333333,0.347395833333333,1.38854166666667,1.04114583333333,0.694270833333333,0.347395833333333,1.38854166666667,1.04114583333333,0.694270833333333,0.347395833333333,1.38854166666667,1.04114583333333,0.694270833333333,0.347395833333333,
    0.520833333333333,0.520833333333333,0.5203125,0.5203125,0.347395833333333,0.347395833333333,1.38854166666667,1.04114583333333,0.694270833333333,0.347395833333333,1.38854166666667,1.04114583333333,0.694270833333333,0.347395833333333,1.38854166666667,1.04114583333333,
    0.694270833333333,0.347395833333333,0.520833333333333,0.520833333333333,0.5203125,0.5203125,0.347395833333333,0.347395833333333,1.38854166666667,1.38854166666667,0.694270833333333,0.694270833333333,1.38854166666667,1.38854166666667,0.694270833333333,0.694270833333333,
    1.38854166666667,1.38854166666667,0.694270833333333,0.694270833333333,1.38854166666667,1.38854166666667,0.694270833333333,0.694270833333333,1.38854166666667,1.38854166666667,0.694270833333333,0.694270833333333,1.38854166666667,1.38854166666667,0.694270833333333,0.694270833333333,
    1.38854166666667,1.38854166666667,0.346875,0.694270833333333,0.694270833333333,1.38854166666667,0.346875,0.694270833333333,0.694270833333333,0.347395833333333,0.0864583333333333,0.0869791666666667,0.0869791666666667,0.347395833333333,0.0864583333333333,0.0869791666666667,
    0.0869791666666667,0.347395833333333,0.0864583333333333,0.0869791666666667,0.0869791666666667,0.347395833333333,0.0864583333333333,0.0869791666666667,0.0869791666666667,0.347395833333333,0.0864583333333333,0.0869791666666667,0.0869791666666667,0.347395833333333,0.0864583333333333,0.0869791666666667,
    0.0869791666666667,0.347395833333333,0.0864583333333333,0.0869791666666667,0.0869791666666667,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,
    0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,1.38854166666667,1.38854166666667,
    0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,
    0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,
    0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,0.347395833333333,1.38854166666667,0.69375,0.694270833333333,1.38854166666667,1.38854166666667,
    0.520833333333333,0.520833333333333,0.5203125,0.5203125,0.347395833333333,0.347395833333333,2.77708333333333,2.77708333333333
    ];
    var melody_time_ary3 = [
    21994,22328,22661,22994,23327,23661,23994,24327,24660,24994,25327,25660,25993,26327,26660,26993,
    27326,27660,27993,28326,28659,28993,29326,29659,29992,30326,30659,30992,31325,31659,31992,32325,
    32658,32992,33325,33658,33991,34325,34658,34991,35324,35658,35991,36324,36657,36991,37324,37657,
    37990,38324,38657,38990,39323,39657,39990,40323,40656,40990,41323,41656,41989,42323,42656,42656,
    42656,43322,43656,43989,44322,44655,44989,45322,45655,45988,46322,46655,46988,47321,47655,47988,
    48321,48654,48988,49321,49654,49987,50321,50654,50987,51320,51654,51987,52320,52653,52987,53320,
    53653,53986,54320,54653,54986,55319,55653,55986,56319,56652,56986,57319,57652,57985,58319,58652,
    58985,59318,59652,59985,60318,60651,60985,61318,61651,61984,62318,62651,62984,63317,63651,63984,
    85312,85312,85645,85645,85978,86312,86645,86978,87311,87645,87978,88311,88644,88978,89311,89644,
    89977,89977,90477,90477,90977,90977,91310,91644,91977,92310,92643,92977,93310,93643,93976,94310,
    94643,94976,95309,95309,95809,95809,96309,96309,96642,96642,97309,97309,97975,97975,98642,98642,
    99308,99308,99975,99975,100641,100641,101308,101308,101974,101974,102641,102641,103307,103307,103974,103974,
    104640,104640,104974,105307,105307,105973,106307,106640,106640,107306,107640,107973,108306,108639,108973,109306,
    109639,109972,110306,110639,110972,111305,111639,111972,112305,112638,112972,113305,113638,113971,114305,114638,
    114971,115304,115638,115971,116304,116637,116971,117304,117637,117970,118304,118637,118970,119303,119637,119970,
    120303,120636,120970,121303,121636,121969,122303,122636,122969,123302,123636,123969,124302,124635,124635,125968,
    126302,126635,126968,127301,127635,127968,128301,128634,128968,129301,129634,129967,130301,130634,130967,131300,
    131634,131967,132300,132633,132967,133300,133633,133966,134300,134633,134966,135299,135633,135966,136299,136632,
    136966,137299,137632,137965,138299,138632,138965,139298,139632,139965,140298,140631,140965,141298,141964,141964,
    143297,143297,143797,143797,144297,144297,144630,144630
    ];
    var melody_data3 = [
    'B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D3','A3','D4','A3',
    'B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D3','A3','D4','A3',
    'A2','E3','A3','E3','G2','D3','G3','D3','F#2','C#3','A3','C#3','B2','F#3','B3','F#3',
    'E2','B2','E3','B2','G2','D3','G3','D3','A2','E3','A3','E3','A2','E3','A3','A2',
    'A1','B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D3','A3','D4',
    'A3','B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D3','A3','D4',
    'A3','A2','E3','A3','E3','G2','D3','G3','D3','F#2','C#3','A3','C#3','B2','F#3','B3',
    'F#3','E2','B2','E3','B2','A2','E3','A3','E3','D2','A2','D3','F#3','A3','F#3','D3',
    'A2','A3','D3','D4','D2','A2','D3','E3','E2','B2','E3','F#3','F#2','C#3','F#3','A3',
    'G3','G2','F#3','F#2','E3','E2','D2','A2','D3','E3','E2','B2','E3','F#3','F#2','C#3',
    'F#3','A3','G3','G2','F#2','F#3','E3','E2','A1','A2','A3','E3','G2','G1','D3','G3',
    'F#2','F#1','C#3','A3','B2','B1','F#3','B3','E1','E2','B2','E3','G1','G2','D3','G3',
    'A1','A2','E3','E3','A3','A2','E3','E3','A3','B2','F#3','B3','F#3','G2','D3','G3',
    'D3','A2','E3','A3','E3','D3','A3','D4','A3','B2','F#3','B3','F#3','G2','D3','G3',
    'D3','A2','E3','A3','E3','D3','A3','D4','A3','A2','E3','A3','E3','G2','D3','G3',
    'D3','F#2','C#3','A3','C#3','B2','F#3','B3','F#3','E2','B2','E3','B2','A2','A1','D2',
    'A2','D3','A2','B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D2',
    'A2','D3','A2','B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','E3','D2',
    'A2','D3','A2','B2','F#3','B3','F#3','G2','D3','G3','D3','A2','E3','A3','D2','D3',
    'G3','G2','F#3','F#2','E3','E2','D3','D2'
    ];
    var melody_volume_ary3 = [
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,117,127,127,117,127,127,127,
    117,127,127,127,117,127,127,127,127,117,127,127,127,117,127,127,
    127,117,127,127,127,117,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127
    ];
    //channel:4
    //inst:41
    var melody_length_ary4 = [
    0.1734375,0.1734375,0.0864583333333333,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,
    0.1734375,0.694791666666667,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,
    0.1734375,0.347395833333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,
    0.1734375,0.1734375,0.347395833333333,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,0.347395833333333,0.1734375,0.1734375,0.347395833333333,0.347395833333333,
    0.1734375,0.1734375,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.347395833333333,0.347395833333333,
    0.1734375,0.1734375,0.347395833333333,0.347395833333333,0.1734375,0.1734375,0.347395833333333,0.694270833333333,0.115625,0.115625,0.115625,0.0869791666666667,0.0869791666666667,0.0864583333333333,0.0869791666666667,1.38854166666667,
    1.38854166666667,1.04114583333333,0.347395833333333,1.38854166666667,1.38854166666667,1.04114583333333,0.347395833333333,0.867708333333333,0.1734375,0.173958333333333,0.1734375,1.38854166666667,0.347395833333333,0.1734375,0.1734375,0.1734375,
    0.173958333333333,0.347395833333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.347395833333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.347395833333333,0.1734375,0.1734375,0.1734375,0.173958333333333,
    0.347395833333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.347395833333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.347395833333333,0.1734375,0.1734375,0.1734375,0.173958333333333,0.347395833333333,
    0.1734375,0.1734375,0.1734375,0.173958333333333,1.38854166666667,1.38854166666667,1.38854166666667,0.520833333333333,0.5203125,0.347395833333333,1.38854166666667,1.38854166666667,1.38854166666667,0.520833333333333,0.5203125,0.347395833333333,
    0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.173958333333333,
    0.1734375,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.173958333333333,
    0.1734375,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.173958333333333,
    0.1734375,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.173958333333333,
    0.1734375,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,1.38854166666667,1.38854166666667,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,0.694270833333333,1.04114583333333,0.347395833333333,3.47135416666667,0.694270833333333,1.04114583333333,0.347395833333333,3.47135416666667,0.694270833333333,1.04114583333333,0.347395833333333,2.77708333333333,
    0.520833333333333,0.5203125,0.347395833333333,2.77708333333333
    ];
    var melody_time_ary4 = [
    16662,16996,17162,17329,17662,17995,18329,18662,18995,19328,19662,19995,20328,20661,20995,21161,
    21494,21661,22328,22661,22994,23327,23661,23994,24327,24660,24994,25327,25660,25993,26327,26493,
    26826,26993,27326,27660,27993,28326,28659,28993,29326,29659,29992,30326,30659,30992,31325,31659,
    31825,32158,32325,32658,33991,35324,36657,37990,39323,40656,41989,43322,43656,43989,44322,44655,
    44989,45322,45655,45988,46322,46655,46988,47321,47655,47988,48321,48654,48988,49321,49654,49987,
    50321,50654,50987,51320,51654,51987,52320,52653,53320,53431,53542,53653,53736,53820,53903,53986,
    55319,56652,57652,57985,59318,60651,61651,61984,62817,62984,63151,63317,75314,75648,75814,75981,
    76314,76647,76981,77147,77314,77647,77980,78314,78480,78647,78980,79313,79647,79813,79980,80313,
    80646,80980,81146,81313,81646,81979,82313,82479,82646,82979,83312,83646,83812,83979,84312,84645,
    84979,85145,85312,85645,85978,87311,88644,89977,90477,90977,91310,92643,93976,95309,95809,96309,
    96976,97309,98309,98642,99642,99975,100975,101308,102308,102641,103641,103974,104974,105307,107306,107473,
    107640,107806,107973,108139,108306,108473,108639,108806,108973,109139,109306,109472,109639,109806,109972,110139,
    110306,110472,110639,110805,110972,111139,111305,111472,111639,111805,111972,112138,112305,112472,112638,112805,
    112972,113138,113305,113471,113638,113805,113971,114138,114305,114471,114638,114804,114971,115138,115304,115471,
    115638,115804,115971,116137,116304,116471,116637,116804,116971,117137,117304,117470,117637,117804,117970,119303,
    120636,121969,123302,124635,126635,127301,128301,128634,131967,132633,133633,133966,137299,137965,138965,139298,
    143297,143797,144297,144630
    ];
    var melody_data4 = [
    'B5','F#5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5',
    'F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5',
    'F#5','B4','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5','B5','F#5',
    'B5','F#5','B5','A4','G4','F#4','B4','F#4','F#4','F#4','A4','B4','F#5','B5','F#5','G4',
    'D5','G5','D5','A4','E5','A5','E5','D5','A5','D6','A5','B4','F#5','B5','F#5','G4',
    'D5','G5','D5','A4','E5','A5','E5','D5','D4','F#4','A4','D5','E5','F#5','G5','A5',
    'G5','F#5','A5','B5','E5','A5','F#5','D5','A5','D6','A5','A6','B5','F#5','A5','B5',
    'F#5','B5','F#5','A5','B5','F#5','B5','F#5','A5','B5','F#5','B5','F#5','A5','B5','F#5',
    'B5','F#5','A5','B5','F#5','B5','F#5','A5','B5','F#5','B5','F#5','A5','B5','F#5','B5',
    'F#5','A5','B5','F#5','F#4','G4','A4','B4','A4','G4','F#4','G4','A4','B4','A4','G4',
    'A4','A4','G4','G4','F#4','F#4','B4','B4','B4','B4','B4','B4','A4','A4','B4','F#5',
    'B5','F#5','D6','F#5','B5','F#5','G4','D5','G5','D5','A5','D5','G5','D5','A4','E5',
    'A5','E5','B5','E5','A5','E5','D4','A4','D5','A5','G5','F#5','E5','D5','B4','F#5',
    'B5','F#5','D6','F#5','B5','F#5','G4','D5','G5','D5','A5','D5','G5','D5','A4','E5',
    'A5','E5','B5','E5','A5','E5','D4','A4','D5','A4','D5','A4','B4','G4','A4','G4',
    'F#4','B4','E4','A5','D6','C#6','A5','F#5','D6','C#6','A5','B5','D6','C#6','A5','F#5',
    'B4','A4','G4','F#4'
    ];
    var melody_volume_ary4 = [
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127
    ];
    //channel:5
    //inst:41
    var melody_length_ary5 = [
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,2.77708333333333,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,0.1734375,0.173958333333333,0.1734375,0.1734375,0.1734375,0.1734375,0.173958333333333,0.1734375,1.38854166666667,1.38854166666667,1.38854166666667,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,0.520833333333333,0.5203125,0.347395833333333,
    1.38854166666667,1.38854166666667,1.38854166666667,0.520833333333333,0.5203125,0.347395833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,
    0.1734375,0.694270833333333,0.1734375,0.694270833333333,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,
    1.38854166666667,1.38854166666667,0.694270833333333,1.04114583333333,0.347395833333333,3.47135416666667,0.694270833333333,1.04114583333333,0.347395833333333,3.47135416666667,0.694270833333333,1.04114583333333,0.347395833333333,2.77708333333333,0.520833333333333,0.5203125,
    0.347395833333333,2.77708333333333
    ];
    var melody_time_ary5 = [
    11330,12663,13996,15329,16662,17995,19328,20661,21994,23327,24660,25993,27326,28659,29992,31325,
    32658,33991,35324,36657,37990,39323,40656,43322,44655,45988,47321,48654,49987,51320,52653,53986,
    55319,56652,57985,59318,60651,61984,62151,62318,62484,62651,62817,62984,63151,63317,69982,71315,
    72648,73981,75314,76647,77980,79313,80646,81979,83312,84645,85978,87311,88644,89977,90477,90977,
    91310,92643,93976,95309,95809,96309,96976,97309,98309,98642,99642,99975,100975,101308,102308,102641,
    103641,103974,104974,105307,107306,108639,109972,111305,112638,113971,115304,116637,117970,119303,120636,121969,
    123302,124635,126635,127301,128301,128634,131967,132633,133633,133966,137299,137965,138965,139298,143297,143797,
    144297,144630
    ];
    var melody_data5 = [
    'F#4','D4','E4','A3','F#4','D4','E4','A3','F#4','D4','E4','A3','F#4','D4','E4','A3',
    'C#4','B3','A3','D4','G3','B3','C#4','F#4','D4','E4','A3','F#4','D4','E4','A3','C#4',
    'B3','A3','D4','G3','C#4','D3','A3','D4','F#4','A4','F#4','D5','A4','F#4','F#4','D4',
    'E4','A3','F#4','D4','E4','A3','F#4','D4','E4','A3','D4','E4','F#4','G4','F#4','E4',
    'D4','E4','F#4','G4','F#4','E4','E4','E4','D4','D4','C#4','C#4','F#4','F#4','F#4','F#4',
    'F#4','F#4','E4','E4','F#4','D4','E4','A3','F#4','D4','E4','A3','C#4','B3','A3','D4',
    'G3','C#4','D5','C#5','A4','F#4','D5','C#5','A4','B4','D5','C#5','A4','F#4','G4','F#4',
    'E4','D4'
    ];
    var melody_volume_ary5 = [
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127
    ];
    //channel:6
    //inst:42
    var melody_length_ary6 = [
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,2.77708333333333,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,2.77708333333333,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,0.520833333333333,0.5203125,0.347395833333333,1.38854166666667,1.38854166666667,1.38854166666667,0.520833333333333,
    0.5203125,0.347395833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,0.1734375,0.694270833333333,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,0.694270833333333,1.04114583333333,
    0.347395833333333,3.47135416666667,0.694270833333333,1.04114583333333,0.347395833333333,3.47135416666667,0.694270833333333,1.04114583333333,0.347395833333333,2.77708333333333,0.520833333333333,0.5203125,0.347395833333333,2.77708333333333
    ];
    var melody_time_ary6 = [
    5998,7331,8664,9997,11330,12663,13996,15329,16662,17995,19328,20661,21994,23327,24660,25993,
    27326,28659,29992,31325,32658,33991,35324,36657,37990,39323,40656,43322,44655,45988,47321,48654,
    49987,51320,52653,53986,55319,56652,57985,59318,60651,61984,69982,71315,72648,73981,75314,76647,
    77980,79313,80646,81979,83312,84645,85978,87311,88644,89977,90477,90977,91310,92643,93976,95309,
    95809,96309,96976,97309,98309,98642,99642,99975,100975,101308,102308,102641,103641,103974,104974,105307,
    107306,108639,109972,111305,112638,113971,115304,116637,117970,119303,120636,121969,123302,124635,126635,127301,
    128301,128634,131967,132633,133633,133966,137299,137965,138965,139298,143297,143797,144297,144630
    ];
    var melody_data6 = [
    'D4','B3','C#4','F#3','D4','B3','C#4','F#3','D4','B3','C#4','F#3','D4','B3','C#4','F#3',
    'D4','B3','C#4','F#3','E4','D4','C#4','F#4','B3','D4','E4','D4','B3','C#4','F#3','D4',
    'B3','C#4','F#3','E4','D4','C#4','F#4','B3','E4','A4','D4','B3','C#4','F#3','D4','B3',
    'C#4','F#3','D4','B3','C#4','F#3','A3','B3','C#4','D4','C#4','B3','A3','B3','C#4','D4',
    'C#4','B3','C#4','C#4','B3','B3','A3','A3','D4','D4','D4','D4','D4','D4','C#4','C#4',
    'D4','B3','C#4','F#3','D4','B3','C#4','F#3','E4','D4','C#4','F#4','B3','E4','B4','A4',
    'F#4','D4','B4','A4','F#4','G4','B4','A4','F#4','D4','D4','C#4','B3','A3'
    ];
    var melody_volume_ary6 = [
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127
    ];
    //channel:7
    //inst:43
    var melody_length_ary7 = [
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,2.77708333333333,1.38854166666667,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,2.77708333333333,1.38854166666667,1.38854166666667,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,
    1.38854166666667,0.520833333333333,0.5203125,0.347395833333333,1.38854166666667,1.38854166666667,1.38854166666667,0.520833333333333,0.5203125,0.347395833333333,0.694270833333333,0.694270833333333,0.694270833333333,0.694270833333333,0.694270833333333,0.694270833333333,
    0.694270833333333,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,
    1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,1.38854166666667,0.520833333333333,0.5203125,0.347395833333333,2.77708333333333
    ];
    var melody_time_ary7 = [
    666,1999,3332,4665,5998,7331,8664,9997,11330,12663,13996,15329,16662,17995,19328,20661,
    21994,23327,24660,25993,27326,28659,29992,31325,32658,33991,35324,36657,37990,39323,40656,43322,
    44655,45988,47321,48654,49987,51320,52653,53986,55319,56652,57985,59318,60651,61984,64650,65983,
    67316,68649,69982,71315,72648,73981,75314,76647,77980,79313,80646,81979,83312,84645,85978,87311,
    88644,89977,90477,90977,91310,92643,93976,95309,95809,96309,97309,98642,99975,101308,102641,103974,
    105307,107306,108639,109972,111305,112638,113971,115304,116637,117970,119303,120636,121969,123302,124635,125968,
    127301,128634,129967,131300,132633,133966,135299,136632,137965,139298,140631,143297,143797,144297,144630
    ];
    var melody_data7 = [
    'B2','G2','A2','D2','B2','G2','A2','D2','B2','G2','A2','D2','B2','G2','A2','D2',
    'B2','G2','A2','D2','B2','G2','A2','D2','A2','G2','F#2','B2','E2','G2','A2','B2',
    'G2','A2','D2','B2','G2','A2','D2','A2','G2','F#2','B2','E2','A2','D2','B2','G2',
    'A2','D2','B2','G2','A2','D2','B2','G2','A2','D2','B2','G2','A2','D2','D2','E2',
    'F#2','G2','F#2','E2','D2','E2','F#2','G2','F#2','E2','A2','G2','F#2','B2','E2','G2',
    'A2','B2','G2','A2','D2','B2','G2','A2','D2','A2','G2','F#2','B2','E2','A2','D3',
    'B2','G2','A2','D3','B2','G2','A2','D3','B2','G2','A2','G2','F#2','E2','D2'
    ];
    var melody_volume_ary7 = [
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
    127,127,127,127,127,127,127,127,127,127,127,127,127,127,127
    ];
    
    
var melody_length_ary = melody_length_ary1;
var melody_time_ary = melody_time_ary1;
var melody_data = melody_data1;
var melodyFlagAry = createBrankAry(melody_time_ary);

var countUp = 0;
var atCount = 0;
var startTime = new Date(), atTime = new Date(), diffTime = new Date();

var beforeX = 0, beforeY = 0;
var norm_threshold = 100;

document.addEventListener("DOMContentLoaded", function(){
    var ripple_wood = document.getElementById("ripple_div");
    
    ripple_wood.addEventListener("click", function (event) { 

        var norm = Math.sqrt( Math.pow(event.pageX - beforeX,2) + Math.pow(event.pageY - beforeY, 2));
        console.log(norm);
        beforeX = event.pageX;
        beforeY = event.pageY;

        var synth = new Tone.Synth().toMaster();
        //synth.volume.value = 1;
        if(count == 0){
            //startAccompaniment(accompaniment_time_ary, accompaniment_data);
            startAccompaniment(melody_time_ary1, melody_data1, melody_length_ary1, melody_volume_ary1, melodyFlagAry, false);
            startAccompaniment(melody_time_ary2, melody_data2, melody_length_ary2, melody_volume_ary2, melodyFlagAry, false);
            startAccompaniment(melody_time_ary3, melody_data3, melody_length_ary3, melody_volume_ary3, melodyFlagAry, false);
            startAccompaniment(melody_time_ary4, melody_data4, melody_length_ary4, melody_volume_ary4, melodyFlagAry, false);
            startAccompaniment(melody_time_ary5, melody_data5, melody_length_ary5, melody_volume_ary5, melodyFlagAry, false);
            startAccompaniment(melody_time_ary6, melody_data6, melody_length_ary6, melody_volume_ary6, melodyFlagAry, false);
            startAccompaniment(melody_time_ary7, melody_data7, melody_length_ary7, melody_volume_ary7, melodyFlagAry, false);

            Tone.Transport.start();
            startTime = new Date();
            atTime = new Date();
            countUp = 0;
            atCount = 0;
        }else{
            atTime = new Date();
        }
        diffTime = atTime.getTime() - startTime.getTime();
        //console.log(diffTime);
        
        var clickSuccessFlag = false;
        for(var i=atCount+1; i<melody_time_ary.length; i++){
           // music_scale = melody_data[countUp];
           // console.log(melody_time_ary[i] * BPNConvertMSEC);
            if((melody_time_ary[i]-100) <= diffTime + melody_time_ary[0]){
                atCount = i;
                clickSuccessFlag = true;
            }
        }

        var rand = Math.round(Math.random() * melody_data.length);
        console.log(rand);
        if(clickSuccessFlag){
            for(var i=atCount; i<atCount+10; i++){
                if(melody_time_ary[atCount] == melody_time_ary[i]){
                    if(melodyFlagAry[i] == 0){
                        if(norm > norm_threshold){
                            //console.log(norm);
                            music_scale = melody_data[i];
                        }
                        melodyFlagAry[i] = 1;
                        ++melodyFlagAry[i];
                    }else{
                        if(norm > norm_threshold){
                            console.log(norm);
                            music_scale = melody_data[rand];
                        }
                        //music_scale = 0;
                    }
                    synth.triggerAttackRelease(music_scale, melody_length_ary[i]);
                }
            }
        }else{
            if(norm > norm_threshold){
                music_scale = melody_data[rand];
            }else{
            }
            synth.triggerAttackRelease(music_scale, "8n");
        }
 
        //music_scale = melody_data[countUp];
        countUp++;

        if((melody_time_ary[melody_time_ary.length-1]) < diffTime){
            //Tone.Transport.stop();
            console.log("Over!");
            count = 0;
            melodyFlagAry = createBrankAry(melody_time_ary);
        }
        else{
            count++;
        }
    }, false);

}, false);

function waitNote(msec, count, mainFlag, flagAry){
    var objDef = new $.Deferred;
    setTimeout(function(){
        objDef.resolve(count, mainFlag, flagAry);
    }, msec);
    return objDef.promise(count, mainFlag, flagAry);
}

function startAccompaniment(timeAry, dataAry, lengthAry, volumeAry, flagAry, mainFlag){
    var synth = new Tone.Synth().toMaster();
    for(var i=0; i<timeAry.length; i++){
        var nextTime = timeAry[i] - melody_time_ary[0];

        waitNote(nextTime, i, mainFlag, flagAry).done(function(count, mainFlag){
            if(mainFlag){
                if(flagAry[count] == 0){
                    synth.volume.value = -0.1*(127 - volumeAry[count]);
                    //synth.volume.value = -20;
                    var scale = dataAry[count];
                    synth.triggerAttackRelease(scale, lengthAry[count]);
                }
            }
            else{
                synth.volume.value = -0.1*(127 - volumeAry[count])/2;
                var scale = dataAry[count];
                synth.triggerAttackRelease(scale, lengthAry[count]); 
            }
        });
    }
}

function createBrankAry(ary){
    var tempAry = {};
    for(var i=0; i<ary.length; i++){
        tempAry[i] = 0;
    }
    return tempAry;
}
